import{dt as s,du as n,d3 as t,dv as e,dw as i,dx as r,dy as a,B as o,dz as m}from"./vendor.7103ff48.js";import{t as h}from"./json.62026198.js";const u=[0,0];function c(s,n){if(!n)return null;if("x"in n){const t={x:0,y:0};return[t.x,t.y]=s(n.x,n.y,u),null!=n.z&&(t.z=n.z),null!=n.m&&(t.m=n.m),t}if("xmin"in n){const t={xmin:0,ymin:0,xmax:0,ymax:0};return[t.xmin,t.ymin]=s(n.xmin,n.ymin,u),[t.xmax,t.ymax]=s(n.xmax,n.ymax,u),n.hasZ&&(t.zmin=n.zmin,t.zmax=n.zmax,t.hasZ=!0),n.hasM&&(t.mmin=n.mmin,t.mmax=n.mmax,t.hasM=!0),t}return"rings"in n?{rings:l(n.rings,s),hasM:n.hasM,hasZ:n.hasZ}:"paths"in n?{paths:l(n.paths,s),hasM:n.hasM,hasZ:n.hasZ}:"points"in n?{points:p(n.points,s),hasM:n.hasM,hasZ:n.hasZ}:void 0}function l(s,n){const t=[];for(const e of s)t.push(p(e,n));return t}function p(s,n){const t=[];for(const e of s){const s=n(e[0],e[1],[0,0]);t.push(s),e.length>2&&s.push(e[2]),e.length>3&&s.push(e[3])}return t}async function f(s,n){if(!n)return;const t=Array.isArray(s)?s.map((s=>o(s.geometry)&&s.geometry.spatialReference)):[s];await m(t.map((s=>({source:s,dest:n}))))}const x=c.bind(null,s),y=c.bind(null,n);function d(s,n,o){return s?(o||(o=n,n=s.spatialReference),t(n)&&t(o)&&!e(n,o)?i(n,o)?r(o)?x(s):y(s):a(h,[s],n,o,null)[0]:s):s}const _=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(s,n,t){if(!s||!s.length||!n||!t||e(n,t))return s;const i={geometries:s,inSpatialReference:n,outSpatialReference:t,resolve:null};return this._jobs.push(i),new Promise((s=>{i.resolve=s,null===this._timer&&(this._timer=setTimeout(this._process,10))}))}_process(){this._timer=null;const s=this._jobs.shift();if(!s)return;const{geometries:n,inSpatialReference:t,outSpatialReference:e,resolve:o}=s;i(t,e)?r(e)?o(n.map(x)):o(n.map(y)):o(a(h,n,t,e,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};function g(s,n,t){return _.push(s,n,t)}export{g as M,f,d as g};
//# sourceMappingURL=projectionSupport.c5c55ada.js.map
