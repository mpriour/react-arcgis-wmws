{"version":3,"file":"GraphicsLayerView3D.1dfc06b1.js","sources":["../../node_modules/@arcgis/core/views/3d/layers/GraphicsLayerView3D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as i}from\"../../../chunks/tslib.es6.js\";import{isSome as e}from\"../../../core/maybe.js\";import{whenTrueOnce as s,init as t,watch as r}from\"../../../core/watchUtils.js\";import{property as a}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/Logger.js\";import{subclass as p}from\"../../../core/accessorSupport/decorators/subclass.js\";import{LayerView3D as h}from\"./LayerView3D.js\";import n from\"./graphics/Graphics3DFrustumVisibility.js\";import o from\"./graphics/Graphics3DGraphicLikeLayerView.js\";import{enlargeExtent as c}from\"./graphics/graphicUtils.js\";import{toViewIfLocal as d}from\"./support/projectExtentUtils.js\";import u from\"../../layers/LayerView.js\";const l=1.2;let g=class extends(h(u)){constructor(){super(...arguments),this.type=\"graphics-3d\",this.frustumVisibility=new n,this.slicePlaneEnabled=!1,this.drapeSourceType=1,this.suspendResumeExtent=null,this.fullExtentInLocalViewSpatialReference=null}initialize(){this._set(\"graphics3d\",new o({owner:this,layer:this.layer,scaleVisibilityEnabled:!0})),this.graphics3d.setup(),this.frustumVisibility.setup(this),this.setupSuspendResumeExtent(),this.updatingHandles.add(this,\"fullOpacity\",(()=>this.graphics3d.graphicsCore.opacityChange())),this.handles.add(this.layer.on(\"graphic-update\",(i=>this.graphics3d.graphicsCore.graphicUpdateHandler(i)))),this.addResolvingPromise(d(this).then((i=>this.fullExtentInLocalViewSpatialReference=i))),this.layer.internal?this.notifyChange(\"updating\"):this.handles.add(s(this.view,\"basemapTerrain.ready\",(()=>this.notifyChange(\"updating\"))))}destroy(){this.frustumVisibility&&(this.frustumVisibility.destroy(),this._set(\"frustumVisibility\",null)),this.graphics3d&&(this.graphics3d.destroy(),this._set(\"graphics3d\",null))}get legendEnabled(){return this.canResume()&&!this.frustumVisibility.suspended}get suspendInfo(){var i;const s={};return e(this.graphics3d.scaleVisibility)&&this.graphics3d.scaleVisibility.suspended&&(s.outsideScaleRange=!0),s.outsideOfView=!(null==(i=this.frustumVisibility)||!i.suspended),s}async fetchPopupFeatures(i,s){return e(s)?s.clientGraphics:null}notifyGraphicGeometryChanged(i){this.graphics3d.graphicsCore.notifyGraphicGeometryChanged(i)}notifyGraphicVisibilityChanged(i){this.graphics3d.graphicsCore.notifyGraphicVisibilityChanged(i)}get graphics3DGraphics(){return this.graphics3d.graphicsCore.graphics3DGraphics}get graphics3DGraphicsByObjectID(){return this.graphics3d?this.graphics3d.graphicsCore.graphics3DGraphicsByObjectID:null}get symbolUpdateType(){return this.graphics3d.graphicsCore.symbolUpdateType}getGraphicFromGraphicUid(i){return this.graphics3d.getGraphicFromGraphicUid(i)}whenGraphicBounds(i,e){return this.graphics3d.whenGraphicBounds(i,e)}computeAttachmentOrigin(i,e){return this.graphics3d?this.graphics3d.graphicsCore.computeAttachmentOrigin(i,e):null}getSymbolLayerSize(i,e){return this.graphics3d.getSymbolLayerSize(i,e)}queryGraphics(){return Promise.resolve(this.loadedGraphics)}maskOccludee(i){return this.graphics3d.maskOccludee(i)}highlight(i){return this.graphics3d.highlight(i)}get updatePolicy(){var i;return(null==(i=this.graphics3d)?void 0:i.graphicsCore.effectiveUpdatePolicy)||1}canResume(){var i;return super.canResume()&&!(null!=(i=this.graphics3d)&&i.suspended)}isUpdating(){var i,e;return!(!(this.graphics3d&&this.graphics3d.updating||this.frustumVisibility&&this.frustumVisibility.updating)&&(this.layer.internal||null!=(i=this.view)&&null!=(e=i.basemapTerrain)&&e.ready))}setupSuspendResumeExtent(){const i=()=>{this.suspendResumeExtent=c(this.graphics3d.graphicsCore.computedExtent,this.suspendResumeExtent,l,this.graphics3d.graphicsCore.extentPadding),this.frustumVisibility.setExtent(this.suspendResumeExtent)};t(this.graphics3d.graphicsCore,\"computedExtent\",(()=>i()),!0),r(this.graphics3d.graphicsCore,\"extentPadding\",(()=>i()),!0)}get performanceInfo(){return{displayedNumberOfFeatures:this.loadedGraphics.length,maximumNumberOfFeatures:-1,totalNumberOfFeatures:-1,nodes:0,core:null,updating:this.updating,elevationUpdating:this.graphics3d.elevationAlignment.updating,visibilityFrustum:!this.frustumVisibility.suspended}}};i([a({aliasOf:\"layer.graphics\"})],g.prototype,\"loadedGraphics\",void 0),i([a({readOnly:!0})],g.prototype,\"suspended\",void 0),i([a({readOnly:!0})],g.prototype,\"legendEnabled\",null),i([a({readOnly:!0})],g.prototype,\"updating\",void 0),i([a()],g.prototype,\"layer\",void 0),i([a({readOnly:!0})],g.prototype,\"frustumVisibility\",void 0),i([a({readOnly:!0})],g.prototype,\"graphics3d\",void 0),i([a({type:Boolean})],g.prototype,\"slicePlaneEnabled\",void 0),i([a({readOnly:!0})],g.prototype,\"suspendInfo\",null),g=i([p(\"esri.views.3d.layers.GraphicsLayerView3D\")],g);var y=g;export{y as default};\n"],"names":["g","h","u","constructor","arguments","this","type","frustumVisibility","n","slicePlaneEnabled","drapeSourceType","suspendResumeExtent","fullExtentInLocalViewSpatialReference","initialize","_set","o","owner","layer","scaleVisibilityEnabled","graphics3d","setup","setupSuspendResumeExtent","updatingHandles","add","graphicsCore","opacityChange","handles","on","graphicUpdateHandler","i2","addResolvingPromise","d","then","internal","notifyChange","s","view","destroy","canResume","suspended","e","scaleVisibility","outsideScaleRange","outsideOfView","clientGraphics","notifyGraphicGeometryChanged","notifyGraphicVisibilityChanged","graphics3DGraphics","graphics3DGraphicsByObjectID","symbolUpdateType","getGraphicFromGraphicUid","whenGraphicBounds","e2","computeAttachmentOrigin","getSymbolLayerSize","queryGraphics","Promise","resolve","loadedGraphics","maskOccludee","highlight","effectiveUpdatePolicy","super","isUpdating","updating","basemapTerrain","ready","i","c","computedExtent","extentPadding","setExtent","r","displayedNumberOfFeatures","length","maximumNumberOfFeatures","totalNumberOfFeatures","nodes","core","elevationUpdating","elevationAlignment","visibilityFrustum","a","aliasOf","prototype","readOnly","Boolean","p","y"],"mappings":"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"}