{"version":3,"file":"TileLayerView.311c44a6.js","sources":["../../node_modules/@arcgis/core/views/layers/TileLayerView.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Error.js\";import{isSome as t}from\"../../core/maybe.js\";import{eachAlways as o}from\"../../core/promiseUtils.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import{calculateTolerance as p}from\"../../renderers/support/clickToleranceUtils.js\";const i=i=>{let c=class extends i{async fetchPopupFeatures(e,s){const{layer:a}=this;if(!e)return Promise.reject(new r(\"tilelayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:a}));if(\"tile\"!==a.type)return Promise.reject(new r(\"tilelayerview:fetchPopupFeatures\",\"Layer type should be 'tile'\",{type:a.type}));const i=this.get(\"view.scale\"),c=a.allSublayers.toArray().filter((e=>{const r=0===e.minScale||i<=e.minScale,t=0===e.maxScale||i>=e.maxScale;return e.popupTemplate&&e.popupEnabled&&e.visible&&r&&t}));return o(c.map((async r=>{const o=r.createQuery(),a=t(s)?s.event:null,i=p({renderer:r.renderer,event:a});o.geometry=this.createFetchPopupFeaturesQueryGeometry(e,i),o.outFields=await r.popupTemplate.getRequiredFields();return(await r.queryFeatures(o)).features}))).then((e=>[].concat(...e.map((e=>e.value)).filter(Boolean))))}};return e([s()],c.prototype,\"layer\",void 0),c=e([a(\"esri.layers.mixins.TileLayerView\")],c),c};export{i as TileLayerView,i as default};\n"],"names":["i","c","i2","e2","s","layer","a","this","Promise","reject","r","type","i3","get","c2","allSublayers","toArray","filter","r2","e3","minScale","t","maxScale","popupTemplate","popupEnabled","visible","o","map","async","createQuery","a2","event","i4","p","renderer","geometry","createFetchPopupFeaturesQueryGeometry","outFields","getRequiredFields","queryFeatures","features","then","concat","e4","value","Boolean","e","prototype"],"mappings":"mIAIihB,MAACA,UAAUC,EAAE,cAAcC,2BAA2BC,EAAEC,SAASC,MAAMC,GAAGC,SAASJ,SAASK,QAAQC,OAAO,IAAIC,EAAE,mCAAmC,gCAAgC,CAACL,MAAMC,QAAQ,SAASA,EAAEK,YAAYH,QAAQC,OAAO,IAAIC,EAAE,mCAAmC,8BAA8B,CAACC,KAAKL,EAAEK,cAAcC,EAAEL,KAAKM,IAAI,cAAcC,EAAER,EAAES,aAAaC,UAAUC,kBAAkBC,EAAE,IAAIC,EAAEC,UAAUR,GAAGO,EAAEC,SAASC,EAAE,IAAAF,EAAMG,UAAUV,GAAGO,EAAEG,gBAAgBH,EAAEI,eAAeJ,EAAEK,cAAcL,EAAEM,SAASP,GAAGG,YAAYK,EAAEZ,EAAEa,KAAKC,MAAMlB,UAAUgB,EAAEhB,EAAEmB,cAAcC,EAAET,EAAEjB,GAAGA,EAAE2B,MAAM,KAAKC,EAAEC,EAAE,CAACC,SAASxB,EAAEwB,SAASH,MAAMD,aAAMK,SAAS5B,KAAK6B,sCAAsCjC,EAAE6B,GAAGN,EAAEW,gBAAgB3B,EAAEa,cAAce,2BAAiC5B,EAAE6B,cAAcb,IAAIc,aAAaC,SAAS,GAAGC,UAAUvB,EAAEQ,QAAQgB,EAAEC,QAAQ3B,OAAO4B,qBAAqBC,EAAE,CAAC1C,KAAKH,EAAE8C,UAAU,aAAQ,GAAQ9C,EAAE6C,EAAE,CAACxC,EAAE,qCAAqCL,GAAGA"}