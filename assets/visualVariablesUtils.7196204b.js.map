{"version":3,"file":"visualVariablesUtils.7196204b.js","sources":["../../node_modules/@arcgis/core/views/2d/engine/webgl/color.js","../../node_modules/@arcgis/core/views/2d/engine/webgl/util/debug.js","../../node_modules/@arcgis/core/views/2d/layers/features/tileRenderers/support/visualVariablesUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{i8888to32 as r}from\"./number.js\";const n=[255,255,255,1],t=[0,0,0,0];function u(r,n){return Array.isArray(n)?(r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3]):(r[0]=n.r,r[1]=n.g,r[2]=n.b,r[3]=n.a),r}function o(r,n=0,t=!1){const u=r[n+3];return r[n+0]*=u,r[n+1]*=u,r[n+2]*=u,t||(r[n+3]*=255),r}function c(r){return o(u([],r))}function e(n){return o(u(t,n)),r(t[0],t[1],t[2],t[3])}function i(n){if(!n)return 0;const{r:t,g:u,b:o,a:c}=n;return r(t*c,u*c,o*c,255*c)}function f(n){if(!n)return 0;const[t,u,o,c]=n;return r(t*(c/255),u*(c/255),o*(c/255),c)}export{c as copyAndPremultiply,o as premultiplyAlpha,i as premultiplyAlphaRGBA,f as premultiplyAlphaRGBAArray,e as premultiplyAlphaUint32,n as white};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nconst n=(n,l)=>n&&((...n)=>l.warn(\"DEBUG:\",...n))||(()=>null),l=!1;export{l as DEBUG_ATTR_UPDATES,n as createDebugLogger};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{isNone as e}from\"../../../../../../core/maybe.js\";import{toPt as t,pt2px as s}from\"../../../../../../core/screenUtils.js\";import{premultiplyAlpha as n}from\"../../../../engine/webgl/color.js\";import{NAN_MAGIC_NUMBER as o}from\"../../../../engine/webgl/definitions.js\";import{WGLVVFlag as i}from\"../../../../engine/webgl/enums.js\";import{getTypeOfSizeVisualVariable as l}from\"../../../../engine/webgl/visualVariablesUtils.js\";function r(e,t){if(!e||!t)return e;switch(t){case\"radius\":case\"distance\":return 2*e;case\"diameter\":case\"width\":return e;case\"area\":return Math.sqrt(e)}return e}function a(e){return{value:e.value,size:t(e.size)}}function u(e){return e.map((e=>a(e)))}function c(e){if(\"string\"==typeof e||\"number\"==typeof e)return t(e);const s=e;return{type:\"size\",expression:s.expression,stops:u(s.stops)}}function p(e){const t=e&&e.length>0?{}:null;return t&&e.forEach((e=>{const s=e.type;e.field&&(t[s]=e.field)})),t}const f=e=>{const t=[],n=[],i=u(e),l=i.length;for(let r=0;r<6;r++){const e=i[Math.min(r,l-1)];t.push(e.value),n.push(null==e.size?o:s(e.size))}return{values:new Float32Array(t),sizes:new Float32Array(n)}};function m(e){const t=e&&e.length>0?{}:null,s=t?{}:null;if(!t)return{vvFields:t,vvRanges:s};for(const n of e)if(n.field&&(t[n.type]=n.field),\"size\"===n.type){s.size||(s.size={});const e=n;switch(l(e)){case i.SIZE_MINMAX_VALUE:s.size.minMaxValue={minDataValue:e.minDataValue,maxDataValue:e.maxDataValue,minSize:c(e.minSize),maxSize:c(e.maxSize)};break;case i.SIZE_SCALE_STOPS:s.size.scaleStops={stops:u(e.stops)};break;case i.SIZE_FIELD_STOPS:if(e.levels){const t={};for(const s in e.levels)t[s]=f(e.levels[s]);s.size.fieldStops={type:\"level-dependent\",levels:t}}else s.size.fieldStops={type:\"static\",...f(e.stops)};break;case i.SIZE_UNIT_VALUE:s.size.unitValue={unit:e.valueUnit,valueRepresentation:e.valueRepresentation}}}else if(\"color\"===n.type)s.color=y(n);else if(\"opacity\"===n.type)s.opacity=v(n);else if(\"rotation\"===n.type){const e=n;s.rotation={type:e.rotationType}}return{vvFields:t,vvRanges:s}}function v(e){const t={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if(\"string\"==typeof e.field){if(!e.stops)return null;{if(e.stops.length>8)return null;const s=e.stops;for(let e=0;e<8;++e){const n=s[Math.min(e,s.length-1)];t.values[e]=n.value,t.opacities[e]=n.opacity}}}else{if(!(e.stops&&e.stops.length>=0))return null;{const s=e.stops&&e.stops.length>=0&&e.stops[0].opacity;for(let e=0;e<8;e++)t.values[e]=1/0,t.opacities[e]=s}}return t}function g(e,t,s){e[4*t+0]=s.r/255,e[4*t+1]=s.g/255,e[4*t+2]=s.b/255,e[4*t+3]=s.a}function y(t){if(e(t))return null;if(t.normalizationField)return null;const s={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if(\"string\"==typeof t.field){if(!t.stops)return null;{if(t.stops.length>8)return null;s.field=t.field;const e=t.stops;for(let t=0;t<8;++t){const n=e[Math.min(t,e.length-1)];s.values[t]=n.value,g(s.colors,t,n.color)}}}else{if(!(t.stops&&t.stops.length>=0))return null;{const e=t.stops&&t.stops.length>=0&&t.stops[0].color;for(let t=0;t<8;t++)s.values[t]=1/0,g(s.colors,t,e)}}for(let e=0;e<32;e+=4)n(s.colors,e,!0);return s}export{y as convertColorVariable,m as convertVisualVariables,r as getVisualVariableSizeValueRepresentationRatio,p as getVisualVariablesFields,c as normalizeSizeElement,u as normalizeSizeStops,a as stopToSizeStop};\n"],"names":["r2","n2","t2","u2","r","g","b","o2","a","c2","n","l2","n3","warn","l","e","Math","sqrt","map","value","size","t","e2","s","type","expression","stops","u","f","i2","length","min","push","o","values","Float32Array","sizes","vvFields","vvRanges","field","i","SIZE_MINMAX_VALUE","minMaxValue","minDataValue","maxDataValue","minSize","c","maxSize","SIZE_SCALE_STOPS","scaleStops","SIZE_FIELD_STOPS","levels","t3","s2","fieldStops","__spreadValues","SIZE_UNIT_VALUE","unitValue","unit","valueUnit","valueRepresentation","color","y","opacity","v","rotation","rotationType","opacities","normalizationField","colors"],"mappings":"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"}