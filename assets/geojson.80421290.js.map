{"version":3,"file":"geojson.80421290.js","sources":["../../node_modules/@arcgis/core/layers/graphics/sources/geojson/geojson.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Error.js\";import t from\"../../OptimizedFeature.js\";import n from\"../../OptimizedGeometry.js\";const o={LineString:\"esriGeometryPolyline\",MultiLineString:\"esriGeometryPolyline\",MultiPoint:\"esriGeometryMultipoint\",Point:\"esriGeometryPoint\",Polygon:\"esriGeometryPolygon\",MultiPolygon:\"esriGeometryPolygon\"};function r(e){return o[e]}function*i(e){switch(e.type){case\"Feature\":yield e;break;case\"FeatureCollection\":for(const t of e.features)t&&(yield t)}}function*s(e){if(!e)return null;switch(e.type){case\"Point\":yield e.coordinates;break;case\"LineString\":case\"MultiPoint\":yield*e.coordinates;break;case\"MultiLineString\":case\"Polygon\":for(const t of e.coordinates)yield*t;break;case\"MultiPolygon\":for(const t of e.coordinates)for(const e of t)yield*e}}function*c(e,o={}){const{geometryType:i,objectIdField:s}=o;for(const u of e){var c;const{geometry:e,properties:l,id:f}=u;if(e&&r(e.type)!==i)continue;const a=l||{};let y=null!=(c=a[s])?c:null;s&&null!=f&&!a[s]&&(a[s]=y=f);const d=new t(e?p(new n,e,o):null,a,null,y);yield d}}function u(e){for(const t of e)if(t.length>2)return!0;return!1}function l(e){return!a(e)}function f(e){return a(e)}function a(e){let t=0;for(let n=0;n<e.length;n++){const o=e[n],r=e[(n+1)%e.length];t+=o[0]*r[1]-r[0]*o[1]}return t<=0}function y(e){const t=e[0],n=e[e.length-1];return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]||e.push(t),e}function p(e,t,n){switch(t.type){case\"LineString\":return d(e,t,n);case\"MultiLineString\":return g(e,t,n);case\"MultiPoint\":return m(e,t,n);case\"MultiPolygon\":return h(e,t,n);case\"Point\":return w(e,t,n);case\"Polygon\":return P(e,t,n)}}function d(e,t,n){return S(e,t.coordinates,n),e}function g(e,t,n){for(const o of t.coordinates)S(e,o,n);return e}function m(e,t,n){return S(e,t.coordinates,n),e}function h(e,t,n){for(const o of t.coordinates){b(e,o[0],n);for(let t=1;t<o.length;t++)j(e,o[t],n)}return e}function w(e,t,n){return G(e,t.coordinates,n),e}function P(e,t,n){const o=t.coordinates;b(e,o[0],n);for(let r=1;r<o.length;r++)j(e,o[r],n);return e}function b(e,t,n){const o=y(t);l(o)?F(e,o,n):S(e,o,n)}function j(e,t,n){const o=y(t);f(o)?F(e,o,n):S(e,o,n)}function S(e,t,n){for(const o of t)G(e,o,n);e.lengths.push(t.length)}function F(e,t,n){for(let o=t.length-1;o>=0;o--)G(e,t[o],n);e.lengths.push(t.length)}function G(e,t,n){const[o,r,i]=t;e.coords.push(o,r),n.hasZ&&e.coords.push(i||0)}function M(e){switch(typeof e){case\"string\":return\"esriFieldTypeString\";case\"number\":return\"esriFieldTypeDouble\";default:return\"unknown\"}}function I(t){if(!t)throw new e(\"geojson-layer:empty\",\"GeoJSON data is empty\");if(\"Feature\"!==t.type&&\"FeatureCollection\"!==t.type)throw new e(\"geojson-layer:unsupported-geojson-object\",\"missing or not supported GeoJSON object type\",{data:t});const{crs:n}=t;if(!n)return;const o=\"string\"==typeof n?n:\"name\"===n.type?n.properties.name:\"EPSG\"===n.type?n.properties.code:null,r=new RegExp(\".*(CRS84H?|4326)$\",\"i\");if(!o||!r.test(o))throw new e(\"geojson-layer:unsupported-crs\",\"unsupported GeoJSON 'crs' member\",{crs:n})}function T(e,t={}){const n=[],o=new Set,c=new Set;let l,f=!1,a=Number.NEGATIVE_INFINITY,y=null,p=!1,{geometryType:d=null}=t,g=!1;for(const h of i(e)){const{geometry:e,properties:t,id:i}=h;if(!e||(d||(d=r(e.type)),r(e.type)===d)){if(!f){f=u(s(e))}if(p||(p=null!=i,p&&(l=typeof i,\"number\"===l&&(y=Object.keys(t).filter((e=>t[e]===i))))),p&&\"number\"===l&&null!=i&&(a=Math.max(a,i),y.length>1?y=y.filter((e=>t[e]===i)):1===y.length&&(y=t[y[0]]===i?y:[])),!g&&t){let e=!0;for(const r in t){if(o.has(r))continue;const i=t[r];if(null==i){e=!1,c.add(r);continue}const s=M(i);\"unknown\"!==s?(c.delete(r),o.add(r),n.push({name:r,alias:r,type:s})):c.add(r)}g=e}}}const m=y&&1===y.length&&y[0]||null;if(m)for(const r of n)r.name===m&&(r.type=\"esriFieldTypeOID\");return{fields:n,geometryType:d,hasZ:f,maxObjectId:Math.max(0,a),objectIdFieldName:m,objectIdFieldType:l,unknownFields:Array.from(c)}}function k(e,t){return Array.from(c(i(e),t))}export{k as createOptimizedFeatures,r as getGeometryType,T as inferLayerProperties,I as validateGeoJSON};\n"],"names":["o","LineString","MultiLineString","MultiPoint","Point","Polygon","MultiPolygon","e","type","t2","features","coordinates","e2","length","n","o2","r2","push","S","d","g","m","t3","h","G","w","P","y","a","F","lengths","i2","coords","hasZ","data","crs","properties","name","code","RegExp","test","Set","c2","l2","f2","a2","Number","NEGATIVE_INFINITY","y2","p2","geometryType","d2","g2","h2","i","geometry","id","r","u","s","Object","keys","filter","e3","Math","max","has","i3","add","s2","M","delete","alias","m2","fields","maxObjectId","objectIdFieldName","objectIdFieldType","unknownFields","Array","from","objectIdField","u2","t","p","c"],"mappings":"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"}