{"version":3,"file":"PopupSceneLayerView.abc65404.js","sources":["../../node_modules/@arcgis/core/views/3d/layers/support/PopupSceneLayerView.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import r from\"../../../../core/Error.js\";import{isSome as s}from\"../../../../core/maybe.js\";import\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/Logger.js\";import{subclass as t}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{unpackFieldNames as o,populateMissingFields as p}from\"../../../../layers/support/fieldUtils.js\";import{getFetchPopupTemplate as a,getRequiredFields as i}from\"../../../layers/support/popupUtils.js\";const c=c=>{let u=class extends c{_validateFetchPopupFeatures(e){const{layer:s}=this,{popupEnabled:t}=s;if(!t)return new r(\"scenelayerview3d:fetchPopupFeatures\",\"Popups are disabled\",{layer:s});return a(s,e)?void 0:new r(\"scenelayerview3d:fetchPopupFeatures\",\"Layer does not define a popup template\",{layer:s})}async prepareFetchPopupFeatures(e){}async fetchPopupFeatures(e,r){const t=this._validateFetchPopupFeatures(r);if(t)return Promise.reject(t);const c=s(r)?r.clientGraphics:null;if(!c||0===c.length)return Promise.resolve([]);const u=[],n=[],l=\"scene\"===this.layer.type&&s(this.layer.associatedLayer)?this.layer.associatedLayer:this.layer,h=o(this.layer.fieldsIndex,await i(l,a(this.layer,r)));await this.prepareFetchPopupFeatures(h);const y=new Set;for(const s of c)p(h,s,y)?n.push(s):u.push(s);return 0===n.length?Promise.resolve(u):this.whenGraphicAttributes(n,[...y]).catch((()=>n)).then((e=>u.concat(e)))}};return u=e([t(\"esri.views.3d.layers.support.PopupSceneLayerView\")],u),u};export{c as PopupSceneLayerView};\n"],"names":["c","u","c2","_validateFetchPopupFeatures","e2","layer","s","this","popupEnabled","t2","a","r","t","Promise","reject","c3","clientGraphics","length","resolve","u2","n2","l","type","associatedLayer","h","o","fieldsIndex","i","prepareFetchPopupFeatures","y","Set","s2","push","whenGraphicAttributes","catch","then","concat","e3","e"],"mappings":"kIAI8mB,MAACA,UAAUC,EAAE,cAAcC,EAAEC,4BAA4BC,SAASC,MAAMC,GAAGC,MAAMC,aAAaC,GAAGH,SAAMG,EAA6FC,EAAEJ,EAAEF,QAAG,EAAO,IAAIO,EAAE,sCAAsC,yCAAyC,CAACN,MAAMC,IAA9L,IAAIK,EAAE,sCAAsC,sBAAsB,CAACN,MAAMC,oCAAyJF,6BAA6BA,EAAEO,SAASC,EAAEL,KAAKJ,4BAA4BQ,MAAMC,SAASC,QAAQC,OAAOF,SAASG,EAAET,EAAEK,GAAGA,EAAEK,eAAe,SAASD,GAAG,IAAAA,EAAME,cAAcJ,QAAQK,QAAQ,UAAUC,EAAE,GAAGC,EAAE,GAAGC,EAAE,UAAUd,KAAKF,MAAMiB,MAAMhB,EAAEC,KAAKF,MAAMkB,iBAAiBhB,KAAKF,MAAMkB,gBAAgBhB,KAAKF,MAAMmB,EAAEC,EAAElB,KAAKF,MAAMqB,kBAAkBC,EAAEN,EAAEX,EAAEH,KAAKF,MAAMM,WAAWJ,KAAKqB,0BAA0BJ,SAASK,EAAE,IAAIC,cAAcC,KAAKhB,IAAIS,EAAEO,EAAEF,GAAGT,EAAEY,KAAKD,GAAGZ,EAAEa,KAAKD,UAAU,IAAAX,EAAMH,OAAOJ,QAAQK,QAAQC,GAAGZ,KAAK0B,sBAAsBb,EAAE,IAAIS,IAAIK,OAAO,IAAId,IAAIe,SAAShB,EAAEiB,OAAOC,cAAcpC,EAAEqC,EAAE,CAAC1B,EAAE,qDAAqDX,GAAGA"}