{"version":3,"file":"ClosestFacilityTask.348f7352.js","sources":["../../node_modules/@arcgis/core/rest/support/ClosestFacilitySolveResult.js","../../node_modules/@arcgis/core/rest/closestFacility.js","../../node_modules/@arcgis/core/tasks/ClosestFacilityTask.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import\"../../geometry.js\";import e from\"../../Graphic.js\";import{JSONSupport as o}from\"../../core/JSONSupport.js\";import{isSome as t}from\"../../core/maybe.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/Logger.js\";import{reader as i}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as p}from\"../../core/accessorSupport/decorators/subclass.js\";import a from\"../../geometry/SpatialReference.js\";import n from\"./DirectionsFeatureSet.js\";import l from\"./FeatureSet.js\";import m from\"./NAMessage.js\";import u from\"../../geometry/Point.js\";import y from\"../../geometry/Polyline.js\";import c from\"../../geometry/Polygon.js\";function d(r){return r.features.map((o=>{const s=a.fromJSON(r.spatialReference),i=e.fromJSON(o);return t(i.geometry)&&(i.geometry.spatialReference=s),i}))}function f(r){return l.fromJSON(r).features.map((r=>r.geometry))}let g=class extends o{constructor(r){super(r),this.directions=null,this.facilities=null,this.incidents=null,this.messages=null,this.pointBarriers=null,this.polylineBarriers=null,this.polygonBarriers=null,this.routes=null}readFacilities(r){return f(r)}readIncidents(r){return f(r)}readPointBarriers(r,e){return f(e.barriers)}readPolylineBarriers(r){return f(r)}readPolygonBarriers(r){return f(r)}readRoutes(r){return d(r)}};r([s({type:[n]})],g.prototype,\"directions\",void 0),r([s({type:[u]})],g.prototype,\"facilities\",void 0),r([i(\"facilities\")],g.prototype,\"readFacilities\",null),r([s({type:[u]})],g.prototype,\"incidents\",void 0),r([i(\"incidents\")],g.prototype,\"readIncidents\",null),r([s({type:[m]})],g.prototype,\"messages\",void 0),r([s({type:[u]})],g.prototype,\"pointBarriers\",void 0),r([i(\"pointBarriers\",[\"barriers\"])],g.prototype,\"readPointBarriers\",null),r([s({type:[y]})],g.prototype,\"polylineBarriers\",void 0),r([i(\"polylineBarriers\")],g.prototype,\"readPolylineBarriers\",null),r([s({type:[c]})],g.prototype,\"polygonBarriers\",void 0),r([i(\"polygonBarriers\")],g.prototype,\"readPolygonBarriers\",null),r([s({type:[e]})],g.prototype,\"routes\",void 0),r([i(\"routes\")],g.prototype,\"readRoutes\",null),g=r([p(\"esri.rest.support.ClosestFacilitySolveResult\")],g);var j=g;export{j as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport e from\"../request.js\";import{createQueryParamsHelper as r}from\"../core/queryUtils.js\";import{normalizeCentralMeridian as t}from\"../geometry/support/normalizeUtils.js\";import{collectGeometries as i,isInputGeometryZAware as s,fetchServiceDescription as a,dropZValuesOffInputGeometry as o}from\"./networkService.js\";import{parseUrl as n}from\"./utils.js\";import u from\"./support/ClosestFacilitySolveResult.js\";const l=r({accumulateAttributes:{name:\"accumulateAttributeNames\"},attributeParameterValues:!0,directionsTimeAttribute:{name:\"directionsTimeAttributeName\"},impedanceAttribute:{name:\"impedanceAttributeName\"},facilities:!0,incidents:!0,outSpatialReference:{name:\"outSR\",getter:e=>e.outSpatialReference.wkid},pointBarriers:{name:\"barriers\"},polylineBarriers:!0,polygonBarriers:!0,restrictionAttributes:{name:\"restrictionAttributeNames\"},returnPointBarriers:{name:\"returnBarriers\"},returnRoutes:{name:\"returnCFRoutes\"},travelMode:!0});async function c(r,c,m){const f=[],p=[],y={},B={},d=n(r),{path:b}=d;c.incidents&&c.incidents.features&&i(c.incidents.features,p,\"incidents.features\",y),c.facilities&&c.facilities.features&&i(c.facilities.features,p,\"facilities.features\",y),c.pointBarriers&&c.pointBarriers.features&&i(c.pointBarriers.features,p,\"pointBarriers.features\",y),c.polylineBarriers&&c.polylineBarriers.features&&i(c.polylineBarriers.features,p,\"polylineBarriers.features\",y),c.polygonBarriers&&c.polygonBarriers.features&&i(c.polygonBarriers.features,p,\"polygonBarriers.features\",y);const g=await t(p);for(const e in y){const r=y[e];f.push(e),B[e]=g.slice(r[0],r[1])}if(s(B,f)){let e=null;try{e=await a(b,c.apiKey,m)}catch{}e&&!e.hasZ&&o(B,f)}for(const e in B)B[e].forEach(((r,t)=>{c.get(e)[t].geometry=r}));const A={...m,query:{...d.query,...l.toQueryParams(c),f:\"json\"}},{data:j}=await e(`${b}/solveClosestFacility`,A);return u.fromJSON(j)}export{c as solve};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.21/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../chunks/tslib.es6.js\";import{property as s}from\"../core/accessorSupport/decorators/property.js\";import\"../core/has.js\";import\"../core/accessorSupport/ensureType.js\";import\"../core/Logger.js\";import{subclass as o}from\"../core/accessorSupport/decorators/subclass.js\";import{solve as t}from\"../rest/closestFacility.js\";import e from\"./Task.js\";let c=class extends e{constructor(r){super(r),this.url=null}solve(r,s){return t(this.url,r,s)}};r([s()],c.prototype,\"url\",void 0),c=r([o(\"esri.tasks.ClosestFacilityTask\")],c);var p=c;export{p as default};\n"],"names":["r2","l","fromJSON","features","map","r3","geometry","g","o","constructor","this","directions","facilities","incidents","messages","pointBarriers","polylineBarriers","polygonBarriers","routes","readFacilities","f","readIncidents","readPointBarriers","e2","barriers","readPolylineBarriers","readPolygonBarriers","readRoutes","r","s","a","spatialReference","i","e","o2","t","type","n","prototype","u","m","y","c","p","j","accumulateAttributes","name","attributeParameterValues","directionsTimeAttribute","impedanceAttribute","outSpatialReference","getter","wkid","restrictionAttributes","returnPointBarriers","returnRoutes","travelMode","url","solve","async","c2","m2","f2","p2","y2","B","d2","path","b2","g2","push","slice","apiKey","hasZ","forEach","get","A","__spreadProps","query","toQueryParams","data"],"mappings":"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"}