var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,o=(t,r,i)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[r]=i;import{bP as n,F as d,H as l}from"./vendor.7103ff48.js";import{a as h}from"./WGLContainer.6f073475.js";import{l as c}from"./LayerView2D.3bec42c6.js";import p from"./GroupLayerView.1814cfbd.js";import"./brushes.b64b90a9.js";import"./definitions.e5e12ce7.js";import"./Utils.8f00ae04.js";import"./ShaderCompiler.6905b522.js";import"./GeometryUtils.1bcb906c.js";import"./MaterialKey.8df623c8.js";import"./pixelUtils.5eddfa69.js";import"./Container.f525a10f.js";class f extends h{constructor(){super(...arguments),this._lastWidth=0,this._lastHeight=0,this.requiresDedicatedFBO=!1}dispose(){this._renderTarget&&(this._renderTarget.dispose(),this._renderTarget=null)}doRender(e){const t=this.createRenderParams(e),{context:r,painter:i,profiler:s}=t;this._prevFBO=r.getBoundFramebufferObject(),s.recordContainerStart(this.name);const a=this._getFbo(t),o=i.getRenderTarget();r.bindFramebuffer(a),i.setRenderTarget(a),r.setDepthWriteEnabled(!0),r.setColorMask(!0,!0,!0,!0),r.setClearColor(0,0,0,0),r.setClearDepth(1),r.clear(r.gl.COLOR_BUFFER_BIT|r.gl.DEPTH_BUFFER_BIT),r.setDepthWriteEnabled(!1);for(const n of this.children)n.beforeRender(e);for(const n of this.children)n.processRender(t);for(const n of this.children)n.afterRender(e);i.setRenderTarget(o),r.bindFramebuffer(this._prevFBO),i.beforeRenderLayer(t,this._clippingInfos?255:0,this.computedOpacity),r.setStencilTestEnabled(!1),r.setStencilWriteMask(0),i.blitTexture(r,a.colorTexture,9728),i.compositeLayer(t,this.computedOpacity),s.recordContainerEnd()}createRenderParams(e){return n=((e,t)=>{for(var r in t||(t={}))s.call(t,r)&&o(e,r,t[r]);if(i)for(var r of i(t))a.call(t,r)&&o(e,r,t[r]);return e})({},super.createRenderParams(e)),d={blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:1},t(n,r(d));var n,d}_getFbo(e){const{context:t,painter:r}=e,{width:i,height:s}=t.getViewport();if(i!==this._lastWidth||s!==this._lastHeight)if(this._lastWidth=i,this._lastHeight=s,this._renderTarget)this._renderTarget.resize(i,s);else{const e={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:i,height:s},a={colorTarget:0,depthStencilTarget:3};this._renderTarget=new n(t,a,e,r.getSharedStencilBuffer())}return this._renderTarget}}let g=class extends(c(p)){constructor(){super(...arguments),this.container=new f}attach(){this._updateStageChildren(),this.handles.add(this.layerViews.on("after-changes",(()=>this._updateStageChildren())),"grouplayerview2d")}detach(){this.handles.remove("grouplayerview2d"),this.container.removeAllChildren()}hitTest(e,t){return null}update(e){}moveStart(){}viewChange(){}moveEnd(){}_updateStageChildren(){this.container.removeAllChildren(),this.layerViews.forEach(((e,t)=>this.container.addChildAt(e.container,t)))}};g=d([l("esri.views.2d.layers.GroupLayerView2D")],g);var m=g;export{m as default};
//# sourceMappingURL=GroupLayerView2D.b73be49e.js.map
