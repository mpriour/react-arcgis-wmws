(self.webpackChunkreact_arcgis_wmws=self.webpackChunkreact_arcgis_wmws||[]).push([[9813],{52606:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{vF:()=>b,_D:()=>y,Qp:()=>R,zD:()=>h,tB:()=>g,nF:()=>d,VO:()=>M,kr:()=>j});var _core_Error_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(32656),_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(27780),_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(41241),_geometry_Point_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(61106),_geometry_Extent_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(52937),_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_6__=(__webpack_require__(36348),__webpack_require__(93533)),_geometry_projection_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(28449);const u=5e-4,m=function(e,n){const t=(e.isWGS84||e.isWebMercator)&&(n.isWGS84||n.isWebMercator);return!(e.equals(n)||t)};async function h(){if((0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_7__.kR)()||!(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_7__.Gb)())return null;await(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_7__.zD)()}function y(n,t,o){if(!m(n.spatialReference,t))return null;if(!(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_7__.kR)())throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__.Z("rasterprojectionhelper-projectResolution","projection engine is not loaded");return o?(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_7__.rS)(t,n.spatialReference,n):(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_7__.rS)(n.spatialReference,t,n)}function M(n,o,r,s=null){if(n.spatialReference.equals(o))return n;const l=m(n.spatialReference,o);if(l&&!(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_7__.kR)())throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__.Z("rasterprojectionhelper-projectResolution","projection engine is not loaded");const c=r.center,u=new _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_4__.Z({xmin:c.x-n.x/2,xmax:c.x+n.x/2,ymin:c.y-n.y/2,ymax:c.y+n.y/2,spatialReference:n.spatialReference}),p=l?(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_7__.iV)(u,o,s):(0,_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_2__.iV)(u,o);return null==p?null:{x:p.xmax-p.xmin,y:p.ymax-p.ymin}}function w(e,n=.01){return(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_6__.c9)(e)?n/(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_6__.c9)(e):0}function d(o,i,r=null,s=!0){const l=o.spatialReference;if(l.equals(i))return o;const c=m(l,i);if(c&&!(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_7__.kR)())throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__.Z("rasterprojectionhelper-projectResolution","projection engine is not loaded");const p=c?(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_7__.iV)(o,i,r):(0,_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_2__.iV)(o,i);if(p&&s&&i.isGeographic){var f,h;const[e,t]=l.isWebMercator?(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_1__.C5)(l).origin:null!=(f=null==(h=(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_1__.C5)(l))?void 0:h.valid)?f:[],i=w(l);i&&null!=e&&null!=t&&(Math.abs(o.x-e)<i&&Math.abs(180-p.x)<u?p.x-=360:Math.abs(o.x-t)<i&&Math.abs(180+p.x)<u&&(p.x+=360))}return p}function g(i,r,s=null,l=!0){var c,p,f,h;const y=i.spatialReference;if(y.equals(r))return i;const M=m(y,r);if(M&&!(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_7__.kR)())throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__.Z("rasterprojectionhelper-projectExtent","projection engine is not loaded");const g=M?(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_7__.iV)(i,r,s):(0,_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_2__.iV)(i,r);let[R,j]=null!=(c=null==(p=(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_1__.C5)(y))?void 0:p.origin)?c:[];if(g&&l&&y.isWebMercator&&r.isGeographic&&null!=R&&null!=j){const e=.001,n=1e3;if(Math.abs(i.xmin-R)<e&&Math.abs(j-i.xmax)>n&&Math.abs(180-g.xmax)<u){g.xmin=-180;const e=[];e.push(new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_3__.Z(i.xmax,i.ymin,y)),e.push(new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_3__.Z(i.xmax,(i.ymin+i.ymax)/2,y)),e.push(new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_3__.Z(i.xmax,i.ymax,y));const n=e.map((e=>d(e,r,s))).filter((e=>!isNaN(null==e?void 0:e.x))).map((e=>e.x));g.xmax=Math.max.apply(null,n)}if(Math.abs(i.xmax-j)<e&&Math.abs(R-i.xmin)>n&&Math.abs(180+g.xmin)<u){g.xmax=180;const e=[];e.push(new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_3__.Z(i.xmin,i.ymin,y)),e.push(new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_3__.Z(i.xmin,(i.ymin+i.ymax)/2,y)),e.push(new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_3__.Z(i.xmin,i.ymax,y));const n=e.map((e=>d(e,r,s))).filter((e=>!isNaN(null==e?void 0:e.x))).map((e=>e.x));g.xmin=Math.min.apply(null,n)}}[R,j]=r.isWebMercator?(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_1__.C5)(r).origin:null!=(f=null==(h=(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_1__.C5)(r))?void 0:h.valid)?f:[];const b=w(r);return b&&null!=R&&null!=j&&(Math.abs(g.xmin-R)<b&&(g.xmin=R),Math.abs(g.xmax-j)<b&&(g.xmax=j)),g}function R(t,i,r,s=null,l=null,c=!1,x=[32,32]){var u,h;if(m(t.spatialReference,i.spatialReference)&&!(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_7__.kR)())throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__.Z("rasterprojectionhelper-projectResolution","projection engine is not loaded");if(!(t&&i&&r))return null;const{xmin:y,ymin:M,xmax:w,ymax:g}=t,R=t.spatialReference,j=i.spatialReference,[b,v]=null!=(u=null==(h=(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_1__.C5)(R))?void 0:h.valid)?u:[],N={x:x[0]*r.x,y:x[1]*r.y},S={cols:Math.ceil((w-y)/N.x-.1)+1,rows:Math.ceil((g-M)/N.y-.1)+1},z=N.x,W=N.y,G=[];let P,L=!1;for(let e=0;e<S.cols;e++){const n=[];for(let t=0;t<S.rows;t++){let r=d(new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_3__.Z({x:y+z*e,y:g-W*t,spatialReference:R}),j,s);l&&(r=l.inverseTransform(r)),n.push(r),e>0&&c&&r&&P[t]&&null!=b&&r.x<P[t].x&&(r.x+=v-b),r?(G.push((r.x-i.xmin)/(i.xmax-i.xmin)),G.push((i.ymax-r.y)/(i.ymax-i.ymin))):(G.push(NaN),G.push(NaN),L=!0)}P=n}const q=function(e,n){const t=(e[0]+e[4]+e[4*n.cols]+e[4*n.cols+4])/4,o=(e[1]+e[5]+e[4*n.rows+1]+e[4*n.rows+5])/4;return[Math.abs(t-e[2*n.rows+2]),Math.abs(o-e[2*n.rows+3])]}(G,S),A=new Float32Array((S.cols-1)*(S.rows-1)*2*6),E=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),F=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let e=0;e<S.cols-1;e++){for(let n=0;n<S.rows-1;n++){let t=e*S.rows*2+2*n;const o=G[t],i=G[t+1],r=G[t+2],a=G[t+3];t+=2*S.rows;const s=G[t],l=G[t+1],c=G[t+2],x=G[t+3];let u=0,m=12*(n*(S.cols-1)+e);for(let e=0;e<3;e++)A[m++]=E[u++]*o+E[u++]*r+E[u++]*c;u=0;for(let e=0;e<3;e++)A[m++]=E[u++]*i+E[u++]*a+E[u++]*x;u=0;for(let e=0;e<3;e++)A[m++]=F[u++]*o+F[u++]*s+F[u++]*c;u=0;for(let e=0;e<3;e++)A[m++]=F[u++]*i+F[u++]*l+F[u++]*x}if(L)for(let e=0;e<A.length;e++)isNaN(A[e])&&(A[e]=-1)}return{offsets:G,error:q,coefficients:A,spacing:x,size:[S.cols-1,S.rows-1]}}function j(e,n,t){const i=Math.log(e.x/n.pixelSize.x)/Math.LN2,r=Math.log(e.y/n.pixelSize.y)/Math.LN2,a=n.storageInfo.maximumPyramidLevel||0;let s="down"===t?Math.floor(Math.min(i,r)):"up"===t?Math.ceil(Math.max(i,r)):Math.round((i+r)/2),l=!1;s<0?s=0:s>a&&(l=s>a+3,s=a);const c=2**s;return{pyramidLevel:s,pyramidResolution:new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_3__.Z({x:c*n.nativePixelSize.x,y:c*n.nativePixelSize.y,spatialReference:n.spatialReference}),excessiveReading:l}}function b(e,n,t=512,i=!0){const{extent:a,spatialReference:s,pixelSize:l}=e,c=M(new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_3__.Z({x:l.x,y:l.y,spatialReference:s}),n,a);if(null==c)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const x=(c.x+c.y)/2,u=(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_6__.c9)(n),m=x*u*96*39.37,p=n.isGeographic?512/t*295828763.7958547:512/t*591657527.591555;let f=!1;const h=g(a,n);i&&(n.isGeographic||n.isWebMercator)&&(f=h.xmin*h.xmax<0);let y,w=m;const d=1.001;if(f){w=p;const e=.29858214164761665,n=e*(96*u*39.37);y=M(new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_3__.Z({x:e,y:e,spatialReference:{wkid:3857}}),s,h),y.x*=w/n,y.y*=w/n}else{y={x:l.x,y:l.y};const n=Math.ceil(Math.log(Math.min(e.width,e.height)/32)/Math.LN2);let t=0;for(;w<p*(d/2)&&t<n;)t++,w*=2,y.x*=2,y.y*=2;Math.max(w,p)/Math.min(w,p)<=d&&(w=p)}const R=[w],j=[{x:y.x,y:y.y}],v=Math.min(70.5310735,m)/d;for(;w>=v;)w/=2,y.x/=2,y.y/=2,R.push(w),j.push({x:y.x,y:y.y});return{projectedPixelSize:c,scales:R,srcResolutions:j,isCustomTilingScheme:!f}}},82604:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{KC:()=>l,QI:()=>c,Yx:()=>a,BH:()=>p});var _core_maybe_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(59472),_PixelBlock_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(42766);const i=180/Math.PI,n=function(e){return e&&"esri.layers.support.PixelBlock"===e.declaredClass&&e.pixels&&e.pixels.length>0},r=new Map;function a(e,t){return r.get(e)/r.get(t)||1}function o(e){return(450-e)%360}function h(e,t="geographic"){const[n,r]=e,a=Math.sqrt(n*n+r*r);let h=Math.atan2(r,n)*i;return h=(360+h)%360,"geographic"===t&&(h=o(h)),[a,h]}function s(e,t="geographic"){let n=e[1];"geographic"===t&&(n=o(n)),n%=360;const r=e[0];return[r*Math.cos(n/i),r*Math.sin(n/i)]}function l(e,i,r="geographic",a=1){if(!n(e))return e;const{pixels:o,width:l,height:c}=e,p=l*c,u=o[0],x=o[1],m=_PixelBlock_js__WEBPACK_IMPORTED_MODULE_0__.Z.createEmptyBand(e.pixelType,p),f=_PixelBlock_js__WEBPACK_IMPORTED_MODULE_0__.Z.createEmptyBand(e.pixelType,p);let g=0;for(let t=0;t<c;t++)for(let e=0;e<l;e++)"vector-uv"===i?([m[g],f[g]]=h([u[g],x[g]],r),m[g]*=a):([m[g],f[g]]=s([u[g],x[g]],r),m[g]*=a,f[g]*=a),g++;const d=new _PixelBlock_js__WEBPACK_IMPORTED_MODULE_0__.Z({pixelType:e.pixelType,width:e.width,height:e.height,mask:e.mask,validPixelCount:e.validPixelCount,maskIsAlpha:e.maskIsAlpha,pixels:[m,f]});return d.updateStatistics(),d}function c(e,t,i=1){if(1===i||!n(e))return e;const r=e.clone(),{pixels:a,width:o,height:h}=r,s=a[0],l=a[1];let c=0;for(let n=0;n<h;n++)for(let e=0;e<o;e++)"vector-uv"===t?(s[c]*=i,l[c]*=i):s[c]*=i,c++;return r.updateStatistics(),r}function p(t,i,n,r,a){if(!(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_1__.pC)(a)||!a.spatialReference.equals(t.spatialReference))return{extent:t,width:i,height:n};const o=a.xmin,h=a.ymax;r=Math.max(r||0,30);const s=Math.ceil(i*(1/r)),l=Math.ceil(n*(1/r)),c=((t.xmax-t.xmin)/s+(t.ymax-t.ymin)/l)/2;return t.xmin=o+Math.floor((t.xmin-o)/c)*c,t.xmax=o+Math.ceil((t.xmax-o)/c)*c,t.ymin=h+Math.floor((t.ymin-h)/c)*c,t.ymax=h+Math.ceil((t.ymax-h)/c)*c,{extent:t,width:Math.round(t.width/c),height:Math.round(t.height/c)}}r.set("meter-per-second",1),r.set("kilometer-per-hour",.277778),r.set("knots",.514444),r.set("feet-per-second",.3048),r.set("mile-per-hour",.44704)},29720:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{e:()=>_});__webpack_require__(95830);var _chunks_mat3_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(98501),_chunks_mat3f32_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(55955),_chunks_vec2f32_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(27851),_webgl_Texture_js__WEBPACK_IMPORTED_MODULE_6__=(__webpack_require__(5627),__webpack_require__(23660),__webpack_require__(8634)),_DisplayObject_js__WEBPACK_IMPORTED_MODULE_8__=(__webpack_require__(84570),__webpack_require__(56291)),_ImageryBitmapSource_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(64796);function x(t,e,i){const s={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};return e&&i&&(s.width=e,s.height=i),new _webgl_Texture_js__WEBPACK_IMPORTED_MODULE_6__.Z(t,s)}class _ extends _DisplayObject_js__WEBPACK_IMPORTED_MODULE_8__.s{constructor(t=null,e,i=!0){super(),this.requestRenderOnSourceChangedEnabled=i,this._textureInvalidated=!0,this.stencilRef=0,this.coordScale=[1,1],this._height=void 0,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._width=void 0,this.x=0,this.y=0,this.transforms={dvs:(0,_chunks_mat3f32_js__WEBPACK_IMPORTED_MODULE_2__.c)()},this.blendFunction=e,this.source=t,this.requestRender=this.requestRender.bind(this)}destroy(){this._texture&&(this._texture.dispose(),this._texture=null)}get isSourceScaled(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight}get height(){return void 0!==this._height?this._height:this.sourceHeight}set height(t){this._height=t}get source(){return this._source}set source(t){this._source=t,this.invalidateTexture()}get sourceHeight(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height}get sourceWidth(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width}get width(){return void 0!==this._width?this._width:this.sourceWidth}set width(t){this._width=t}beforeRender(t){super.beforeRender(t),this.updateTexture(t)}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())}setTransform(h){const o=(0,_chunks_mat3_js__WEBPACK_IMPORTED_MODULE_1__.i)(this.transforms.dvs),[u,a]=h.toScreenNoRotation([0,0],this.x,this.y),d=this.resolution/this.pixelRatio/h.resolution,c=d*this.width,l=d*this.height,x=Math.PI*this.rotation/180;(0,_chunks_mat3_js__WEBPACK_IMPORTED_MODULE_1__.a)(o,o,(0,_chunks_vec2f32_js__WEBPACK_IMPORTED_MODULE_3__.f)(u,a)),(0,_chunks_mat3_js__WEBPACK_IMPORTED_MODULE_1__.a)(o,o,(0,_chunks_vec2f32_js__WEBPACK_IMPORTED_MODULE_3__.f)(c/2,l/2)),(0,_chunks_mat3_js__WEBPACK_IMPORTED_MODULE_1__.r)(o,o,-x),(0,_chunks_mat3_js__WEBPACK_IMPORTED_MODULE_1__.a)(o,o,(0,_chunks_vec2f32_js__WEBPACK_IMPORTED_MODULE_3__.f)(-c/2,-l/2)),(0,_chunks_mat3_js__WEBPACK_IMPORTED_MODULE_1__.j)(o,o,(0,_chunks_vec2f32_js__WEBPACK_IMPORTED_MODULE_3__.f)(c,l)),(0,_chunks_mat3_js__WEBPACK_IMPORTED_MODULE_1__.m)(this.transforms.dvs,h.displayViewMat3,o)}setSamplingProfile(t){this._texture&&(t.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(t.samplingMode))}bind({context:t},e){this._texture&&t.bindTexture(this._texture,e)}updateTexture({context:t}){var e;if(!this.stage)return null==(e=this._texture)||e.dispose(),void(this._texture=null);if(!this._textureInvalidated)return;this._textureInvalidated=!1,this._texture||(this.source?this._texture=x(t,this.sourceWidth,this.sourceHeight):this._texture=x(t));const i=this.source;if(i){if(this._texture.resize(this.sourceWidth,this.sourceHeight),function d(t){return t&&"render"in t}(i))if(i instanceof _ImageryBitmapSource_js__WEBPACK_IMPORTED_MODULE_9__.Z){const t=i.getRenderedRasterPixels();this._texture.setData(t.renderedRasterPixels)}else this._texture.setData(function l(t){const e=document.createElement("canvas");return e.width=t.width,e.height=t.height,t.render(e.getContext("2d")),e}(i));else(function c(t){return t&&!("render"in t)})(i)&&this._texture.setData(i);this.ready()}else this._texture.setData(null)}onAttach(){this.invalidateTexture()}onDetach(){this.invalidateTexture()}}},28511:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{c:()=>t});var _webgl_enums_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(31514),_brushes_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(32825),_webgl_WGLContainer_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(23956);class t extends _webgl_WGLContainer_js__WEBPACK_IMPORTED_MODULE_2__.Z{get requiresDedicatedFBO(){return this.children.some((e=>"additive"===e.blendFunction))}prepareRenderPasses(s){const t=s.registerRenderPass({name:"bitmap",brushes:[_brushes_js__WEBPACK_IMPORTED_MODULE_1__.U.bitmap],target:()=>this.children,drawPhase:_webgl_enums_js__WEBPACK_IMPORTED_MODULE_0__.jx.MAP});return[...super.prepareRenderPasses(s),t]}}},64796:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=class e{constructor(e,t,i){this.pixelBlock=e,this.extent=t,this.originalPixelBlock=i}get width(){return this.pixelBlock?this.pixelBlock.width:0}get height(){return this.pixelBlock?this.pixelBlock.height:0}render(e){const t=this.pixelBlock;if(!t)return;const i=this.filter({pixelBlock:t}),l=i.pixelBlock.getAsRGBA(),h=e.createImageData(i.pixelBlock.width,i.pixelBlock.height);h.data.set(l),e.putImageData(h,0,0)}getRenderedRasterPixels(){const e=this.filter({pixelBlock:this.pixelBlock});return{width:e.pixelBlock.width,height:e.pixelBlock.height,renderedRasterPixels:new Uint8Array(e.pixelBlock.getAsRGBA().buffer)}}}},69813:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>ImageryLayerView2D});var tslib_es6=__webpack_require__(56140),Logger=(__webpack_require__(95830),__webpack_require__(36544)),property=(__webpack_require__(68055),__webpack_require__(79881)),subclass=__webpack_require__(87566),watchUtils=(__webpack_require__(10923),__webpack_require__(57002),__webpack_require__(86035),__webpack_require__(80621)),RefreshableLayerView=__webpack_require__(12421),LayerView=__webpack_require__(48164),ImageryLayerView=__webpack_require__(18196),LayerView2D=__webpack_require__(81558),enumeration=__webpack_require__(9870),promiseUtils=__webpack_require__(39105),Accessor=__webpack_require__(82677),Extent=__webpack_require__(52937),screenUtils=__webpack_require__(96071),request=__webpack_require__(36654),Graphic=__webpack_require__(15988),vectorFieldUtils=__webpack_require__(82604),GraphicsCollection=__webpack_require__(99322),rasterProjectionHelper=__webpack_require__(52606),Container=__webpack_require__(17149),GraphicsView2D=__webpack_require__(97422),GraphicContainer=__webpack_require__(24989);const f=Logger.Z.getLogger("esri.views.2d.layers.imagery.ImageryGraphicsView2D");let j=class extends Accessor.Z{constructor(){super(...arguments),this.attached=!1,this.container=new Container.W,this.updateRequested=!1,this._graphicsView=null,this._projectFullExtentPromise=null,this.type="Graphics",this._graphics=new GraphicsCollection.ZP,this._updateGraphics=(0,promiseUtils.Ds)((async(t,e)=>{if(!t.stationary)return;const r=t.state,i=new Extent.Z({xmin:r.extent.xmin,ymin:r.extent.ymin,xmax:r.extent.xmax,ymax:r.extent.ymax,spatialReference:r.spatialReference}),s=t.state.size[0],a=t.state.size[1],o={};o.timeExtent=this.timeExtent,o.requestAsImageElement=!1,o.signal=e,null==this._projectFullExtentPromise&&(this._projectFullExtentPromise=this._getProjectedFullExtent(i.spatialReference));const n="vector-field"===this.layer.renderer.type?this.layer.renderer.symbolTileSize:50,h=await this._projectFullExtentPromise,l=(0,vectorFieldUtils.BH)(i,s,a,n,h),u=await this.layer.fetchImage(l.extent,l.width,l.height,o),d=this.layer.renderer;if("vector-field"===d.type){this._pixelData={extent:l.extent,pixelBlock:u.pixelData.pixelBlock};const e=await d.getGraphicsFromPixelData(u.pixelData,"vector-uv"===this.layer.rasterInfo.dataType);this._graphicsView.update(t),await(0,promiseUtils.e4)(0).then((()=>{this._graphics.set("items",e)}))}}))}destroy(){this.attached&&(this.detach(),this.attached=!1),this.updateRequested=!1}get updating(){return!this.attached||this.isUpdating()}update(t){this._updateGraphics(t).catch((t=>{(0,promiseUtils.D_)(t)||f.error(t)}))}hitTest(t,e){const r=this.view.toMap((0,screenUtils.vW)(t,e));return Promise.resolve(new Graphic.Z({attributes:{},geometry:r,layer:this.layer}))}attach(){this._graphicsView=new GraphicsView2D.Z({view:this.view,graphics:this._graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new GraphicContainer.Z(this.view.featuresTilingScheme)}),this.attached=!0}detach(){this._graphics.destroy(),this._graphicsView.destroy(),this.container.removeChild(this._graphicsView.container),this._graphicsView=null}moveStart(){}viewChange(){}moveEnd(){}install(t){this.container.addChild(this._graphicsView.container),t.addChild(this.container)}uninstall(t){this.container.removeChild(this._graphicsView.container),t.removeChild(this.container)}isUpdating(){return this._graphicsView.updating||this.updateRequested}getPixelData(){return this.updating?null:this._pixelData}redraw(){}requestUpdate(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())}async _getProjectedFullExtent(t){try{return await(0,rasterProjectionHelper.tB)(this.layer.fullExtent,t)}catch(e){try{const e=(await(0,request.default)(this.layer.url,{query:{option:"footprints",outSR:t.wkid||JSON.stringify(t.toJSON()),f:"json"}})).data.featureCollection.layers[0].layerDefinition.extent;return e?Extent.Z.fromJSON(e):null}catch{return null}}}};(0,tslib_es6._)([(0,property.Cb)()],j.prototype,"attached",void 0),(0,tslib_es6._)([(0,property.Cb)()],j.prototype,"container",void 0),(0,tslib_es6._)([(0,property.Cb)()],j.prototype,"layer",void 0),(0,tslib_es6._)([(0,property.Cb)()],j.prototype,"timeExtent",void 0),(0,tslib_es6._)([(0,property.Cb)()],j.prototype,"view",void 0),(0,tslib_es6._)([(0,property.Cb)()],j.prototype,"updateRequested",void 0),(0,tslib_es6._)([(0,property.Cb)()],j.prototype,"updating",null),(0,tslib_es6._)([(0,enumeration.J)({graphics:"Graphics"})],j.prototype,"type",void 0),j=(0,tslib_es6._)([(0,subclass.j)("esri.views.2d.layers.imagery.ImageryGraphicsView2D")],j);const ImageryGraphicsView2D=j;var pixelUtils=__webpack_require__(44464),ImageryBitmapSource=__webpack_require__(64796),BitmapContainer=__webpack_require__(28511),ExportStrategy=__webpack_require__(81186);const u=Logger.Z.getLogger("esri.views.2d.layers.imagery.ImageryView2D");let g=class extends Accessor.Z{constructor(){super(...arguments),this.attached=!1,this.container=new Container.W,this.updateRequested=!1,this.type="Imagery",this._bitmapView=null}destroy(){this.attached&&(this.detach(),this.attached=!1),this.updateRequested=!1}get updating(){return!this.attached||this.isUpdating()}update(e){this.strategy.update(e).catch((e=>{(0,promiseUtils.D_)(e)||u.error(e)}))}detach(){this.strategy.destroy(),this._bitmapView.removeAllChildren(),this.container.removeAllChildren()}hitTest(e,t){const r=this.view.toMap((0,screenUtils.vW)(e,t));return Promise.resolve(new Graphic.Z({attributes:{},geometry:r,layer:this.layer}))}attach(){const e=this.layer.version>=10,t=this.layer.version>=10.1?this.layer.imageMaxHeight:2048,r=this.layer.version>=10.1?this.layer.imageMaxWidth:2048;this._bitmapView=new BitmapContainer.c,this.strategy=new ExportStrategy.Z({container:this._bitmapView,imageNormalizationSupported:e,imageMaxHeight:t,imageMaxWidth:r,fetchSource:this._fetchImage.bind(this),requestUpdate:()=>this.requestUpdate()}),this.attached=!0}moveStart(){}viewChange(){}moveEnd(){}install(e){this.container.addChild(this._bitmapView),e.addChild(this.container)}uninstall(e){this.container.removeChild(this._bitmapView),e.removeChild(this.container)}redraw(){this.strategy.updateExports((e=>{e.source instanceof HTMLImageElement?e.requestRender():this.layer.applyRenderer({pixelBlock:e.source.pixelBlock}).then((t=>{const r=e.source;r.pixelBlock=t.pixelBlock,r.filter=e=>this.layer.applyFilter(e),this.container.requestRender()}))}))}requestUpdate(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate())}isUpdating(){return this.strategy.updating||this.updateRequested}getPixelData(){if(this.updating)return null;const e=this.strategy.container.children;if(1===e.length&&e[0].source)return{extent:e[0].source.extent,pixelBlock:e[0].source.originalPixelBlock};if(e.length>1){const t=this.view.extent,r=e.map((e=>e.source)).filter((e=>e.extent&&e.extent.intersects(t))).map((e=>({extent:e.extent,pixelBlock:e.originalPixelBlock}))),i=(0,pixelUtils.Kh)(r,t);return i?{extent:i.extent,pixelBlock:i.pixelBlock}:null}return null}_fetchImage(e,t,r,i){return(i=i||{}).timeExtent=this.timeExtent,i.requestAsImageElement=!0,this.layer.fetchImage(e,t,r,i).then((e=>e.imageElement?e.imageElement:this.layer.applyRenderer(e.pixelData,{signal:i.signal}).then((t=>{const r=new ImageryBitmapSource.Z(t.pixelBlock,t.extent.clone(),e.pixelData.pixelBlock);return r.filter=e=>this.layer.applyFilter(e),r}))))}};(0,tslib_es6._)([(0,property.Cb)()],g.prototype,"attached",void 0),(0,tslib_es6._)([(0,property.Cb)()],g.prototype,"container",void 0),(0,tslib_es6._)([(0,property.Cb)()],g.prototype,"layer",void 0),(0,tslib_es6._)([(0,property.Cb)()],g.prototype,"strategy",void 0),(0,tslib_es6._)([(0,property.Cb)()],g.prototype,"timeExtent",void 0),(0,tslib_es6._)([(0,property.Cb)()],g.prototype,"view",void 0),(0,tslib_es6._)([(0,property.Cb)()],g.prototype,"updateRequested",void 0),(0,tslib_es6._)([(0,property.Cb)()],g.prototype,"updating",null),(0,tslib_es6._)([(0,enumeration.J)({imagery:"Imagery"})],g.prototype,"type",void 0),g=(0,tslib_es6._)([(0,subclass.j)("esri.views.2d.layers.imagery.ImageryView2D")],g);const ImageryView2D=g;let p=class extends((0,ImageryLayerView.r)((0,RefreshableLayerView.yc)((0,LayerView2D.y)(LayerView.Z)))){constructor(){super(...arguments),this._exportImageVersion=-1}initialize(){this.handles.add((0,watchUtils.S1)(this,["layer.blendMode"],(e=>{this.subview&&(this.subview.container.blendMode=e)}),!0))}get pixelData(){return this.updating?null:this.subview.getPixelData()}get updating(){return!(this.subview&&!this.subview.updating)}hitTest(e,t){return this.suspended||!this.subview?Promise.resolve(null):this.subview.hitTest(e,t)}update(e){var t;null==(t=this.subview)||t.update(e)}attach(){this.layer.increaseRasterJobHandlerUsage(),this._setSubView(),this.handles.add([(0,watchUtils.S1)(this,"layer.exportImageServiceParameters.version",(e=>{this._exportImageVersion!==e&&(this._exportImageVersion=e,this.requestUpdate())})),this.watch("timeExtent",(()=>{this.subview.timeExtent=this.timeExtent,this.requestUpdate()})),this.layer.on("redraw",(()=>this.subview.redraw())),(0,watchUtils.YP)(this.layer,"renderer",(()=>this._setSubView()))],"imagerylayerview-update")}detach(){this.layer.decreaseRasterJobHandlerUsage(),this.subview.destroy(),this.handles.remove("imagerylayerview-update"),this._exportImageVersion=-1}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}async doRefresh(){this.requestUpdate()}isUpdating(){return!this.subview||!this.suspended&&this.subview.isUpdating()}_setSubView(){var e;let t="Imagery";var s,i;"vector-field"===(null==(e=this.layer.renderer)?void 0:e.type)&&"lerc"===this.layer.format&&(t="Graphics"),this.subview&&this.subview.type===t||(null==(s=this.subview)||s.uninstall(this.container),null==(i=this.subview)||i.destroy(),this.subview="Imagery"===t?new ImageryView2D({layer:this.layer,view:this.view,timeExtent:this.timeExtent}):new ImageryGraphicsView2D({layer:this.layer,view:this.view,timeExtent:this.timeExtent}),this.subview.attach(),this.subview.install(this.container),this.subview.container.blendMode=this.layer.blendMode),this.requestUpdate()}};(0,tslib_es6._)([(0,property.Cb)()],p.prototype,"pixelData",null),(0,tslib_es6._)([(0,property.Cb)({readOnly:!0})],p.prototype,"updating",null),(0,tslib_es6._)([(0,property.Cb)()],p.prototype,"subview",void 0),p=(0,tslib_es6._)([(0,subclass.j)("esri.views.2d.layers.ImageryLayerView2D")],p);const ImageryLayerView2D=p},81558:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{y:()=>LayerView2D_l});var tslib_es6=__webpack_require__(56140),property=(__webpack_require__(95830),__webpack_require__(36544),__webpack_require__(68055),__webpack_require__(79881)),subclass=__webpack_require__(87566),Collection=(__webpack_require__(10923),__webpack_require__(57002),__webpack_require__(86035),__webpack_require__(28293)),collectionUtils=__webpack_require__(32105),watchUtils=__webpack_require__(80621),JSONSupport=__webpack_require__(58385);let e=class extends JSONSupport.wq{};e=(0,tslib_es6._)([(0,subclass.j)("esri.views.layers.support.ClipArea")],e);const ClipArea=e;var s;let i=s=class extends ClipArea{constructor(){super(...arguments),this.type="rect",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new s({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}get version(){return(this._get("version")||0)+1}};(0,tslib_es6._)([(0,property.Cb)({type:[Number,String],json:{write:!0}})],i.prototype,"left",void 0),(0,tslib_es6._)([(0,property.Cb)({type:[Number,String],json:{write:!0}})],i.prototype,"right",void 0),(0,tslib_es6._)([(0,property.Cb)({type:[Number,String],json:{write:!0}})],i.prototype,"top",void 0),(0,tslib_es6._)([(0,property.Cb)({type:[Number,String],json:{write:!0}})],i.prototype,"bottom",void 0),(0,tslib_es6._)([(0,property.Cb)({readOnly:!0})],i.prototype,"version",null),i=s=(0,tslib_es6._)([(0,subclass.j)("esri.views.layers.support.ClipRect")],i);const ClipRect=i;var y,Container=__webpack_require__(17149),Geometry=__webpack_require__(39718),Extent=__webpack_require__(52937),Polygon=__webpack_require__(53817),jsonUtils=__webpack_require__(56885);__webpack_require__(36348);const c={base:Geometry.Z,key:"type",typeMap:{extent:Extent.Z,polygon:Polygon.Z}};let n=y=class extends ClipArea{constructor(){super(...arguments),this.type="geometry",this.geometry=null}get version(){return(this._get("version")||0)+1}clone(){return new y({geometry:this.geometry.clone()})}};(0,tslib_es6._)([(0,property.Cb)({types:c,json:{read:jsonUtils.im,write:!0}})],n.prototype,"geometry",void 0),(0,tslib_es6._)([(0,property.Cb)({readOnly:!0})],n.prototype,"version",null),n=y=(0,tslib_es6._)([(0,subclass.j)("esri.views.layers.support.Geometry")],n);const support_Geometry=n;let Path_e=class extends ClipArea{constructor(){super(...arguments),this.type="path",this.path=[]}get version(){return(this._get("version")||0)+1}};(0,tslib_es6._)([(0,property.Cb)({type:[[[Number]]],json:{write:!0}})],Path_e.prototype,"path",void 0),(0,tslib_es6._)([(0,property.Cb)({readOnly:!0})],Path_e.prototype,"version",null),Path_e=(0,tslib_es6._)([(0,subclass.j)("esri.views.layers.support.Path")],Path_e);const Path=Path_e,LayerView2D_c=Collection.Z.ofType({key:"type",base:ClipArea,typeMap:{rect:ClipRect,path:Path,geometry:support_Geometry}}),LayerView2D_l=i=>{let a=class extends i{constructor(){super(...arguments),this.clips=new LayerView2D_c,this.moving=!1,this.attached=!1,this.lastUpdateId=-1,this.updateRequested=!1}initialize(){var t;this.container||(this.container=new Container.W),this.container.fadeTransitionEnabled=!0,this.container.opacity=0,this.container.clips=this.clips,this.handles.add([(0,watchUtils.S1)(this,"suspended",(t=>{this.container&&(this.container.visible=!t),this.view&&!t&&this.updateRequested&&this.view.requestUpdate()}),!0),(0,watchUtils.S1)(this,["layer.opacity","container"],(()=>{var t,e;this.container&&(this.container.opacity=null!=(t=null==(e=this.layer)?void 0:e.opacity)?t:1)}),!0),(0,watchUtils.S1)(this,["layer.blendMode"],(t=>{this.container&&(this.container.blendMode=t)}),!0),(0,watchUtils.S1)(this,["layer.effect"],(t=>{this.container&&(this.container.effect=t)}),!0),this.clips.on("change",(()=>{this.container.clips=this.clips,this.notifyChange("clips")}))]),null!=(t=this.view)&&t.whenLayerView?this.view.whenLayerView(this.layer).then((t=>{t!==this||this.attached||this.destroyed||(this.attach(),this.requestUpdate(),this.attached=!0)}),(()=>{})):this.when().then((()=>{this.attached||this.destroyed||(this.attach(),this.requestUpdate(),this.attached=!0)}),(()=>{}))}destroy(){this.attached&&(this.detach(),this.attached=!1),this.handles.remove("initialize"),this.updateRequested=!1}get updating(){return!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())}isVisibleAtScale(t){let e=!0;const s=this.layer,i=s.minScale,r=s.maxScale;if(null!=i&&null!=r){let s=!i,o=!r;!s&&t<=i&&(s=!0),!o&&t>=r&&(o=!0),e=s&&o}return e}requestUpdate(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())}processUpdate(t){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",t),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(t))):this.updateRequested=!1}isUpdating(){return!1}isRendering(){return!1}canResume(){return!!super.canResume()&&this.isVisibleAtScale(this.view.scale)}};return(0,tslib_es6._)([(0,property.Cb)({type:LayerView2D_c,set(t){const e=(0,collectionUtils.Z)(t,this._get("clips"),LayerView2D_c);this._set("clips",e)}})],a.prototype,"clips",void 0),(0,tslib_es6._)([(0,property.Cb)()],a.prototype,"moving",void 0),(0,tslib_es6._)([(0,property.Cb)()],a.prototype,"attached",void 0),(0,tslib_es6._)([(0,property.Cb)()],a.prototype,"container",void 0),(0,tslib_es6._)([(0,property.Cb)()],a.prototype,"suspended",void 0),(0,tslib_es6._)([(0,property.Cb)({readOnly:!0})],a.prototype,"updateParameters",void 0),(0,tslib_es6._)([(0,property.Cb)()],a.prototype,"updateRequested",void 0),(0,tslib_es6._)([(0,property.Cb)()],a.prototype,"updating",null),(0,tslib_es6._)([(0,property.Cb)()],a.prototype,"view",void 0),a=(0,tslib_es6._)([(0,subclass.j)("esri.views.2d.layers.LayerView2D")],a),a}},24989:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _engine_webgl_enums_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(31514),_BaseGraphicContainer_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(61343);class i extends _BaseGraphicContainer_js__WEBPACK_IMPORTED_MODULE_1__.Z{renderChildren(r){this.attributeView.bindTextures(r.context),this.children.some((e=>e.hasData))&&(super.renderChildren(r),r.drawPhase===_engine_webgl_enums_js__WEBPACK_IMPORTED_MODULE_0__.jx.MAP&&this._renderChildren(r),r.drawPhase===_engine_webgl_enums_js__WEBPACK_IMPORTED_MODULE_0__.jx.HIGHLIGHT&&this._renderHighlight(r))}_renderHighlight(e){const{painter:r}=e,i=r.effects.highlight;i.bind(e),this._renderChildren(e,i.defines),i.draw(e),i.unbind()}}const __WEBPACK_DEFAULT_EXPORT__=i},81186:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>ExportStrategy});var tslib_es6=__webpack_require__(56140),property=(__webpack_require__(95830),__webpack_require__(36544),__webpack_require__(68055),__webpack_require__(79881)),subclass=__webpack_require__(87566),promiseUtils=(__webpack_require__(10923),__webpack_require__(57002),__webpack_require__(86035),__webpack_require__(39105)),Accessor=__webpack_require__(82677),spatialReferenceUtils=__webpack_require__(27780),Extent=__webpack_require__(52937),aaBoundingRect=__webpack_require__(50897),TileInfo=__webpack_require__(40920),TileKey=__webpack_require__(5201),TileInfoView=__webpack_require__(46666);const t=Math.PI/180;function n(n){return n*t}function viewStateUtils_r(t,o){const r=n(o.rotation),u=Math.abs(Math.cos(r)),a=Math.abs(Math.sin(r)),[s,c]=o.size;return t[0]=Math.round(c*a+s*u),t[1]=Math.round(c*u+s*a),t}var Bitmap=__webpack_require__(29720);const ExportStrategy_u=(0,aaBoundingRect.Ue)(),g=[0,0],f=new TileKey.Z(0,0,0,0),x_imageMaxWidth=2048,x_imageMaxHeight=2048,x_imageRotationSupported=!1,x_imageNormalizationSupported=!1,x_hidpi=!1;let y=class extends Accessor.Z{constructor(t){super(t),this._imagePromise=null,this.hidpi=x_hidpi,this.imageMaxWidth=x_imageMaxWidth,this.imageMaxHeight=x_imageMaxHeight,this.imageRotationSupported=x_imageRotationSupported,this.imageNormalizationSupported=x_imageNormalizationSupported,this.update=(0,promiseUtils.Ds)((async(t,e)=>{const i=t.state,o=(0,spatialReferenceUtils.C5)(i.spatialReference),r=this.hidpi?t.pixelRatio:1;if(!t.stationary||this.destroyed)return null;this.imageRotationSupported?(g[0]=i.size[0],g[1]=i.size[1]):viewStateUtils_r(g,i);const a=Math.floor(g[0]*r)>this.imageMaxWidth||Math.floor(g[1]*r)>this.imageMaxHeight,p=o&&(i.extent.xmin<o.valid[0]||i.extent.xmax>o.valid[1]),n=!this.imageNormalizationSupported&&p,m=!a&&!n,l=this.imageRotationSupported?i.rotation:0;if(m)this._imagePromise=this._singleExport(i,g,l,r,e);else{let t=Math.min(this.imageMaxWidth,this.imageMaxHeight);n&&(t=Math.min(i.worldScreenWidth,t)),this._imagePromise=this._tiledExport(i,t,l,r,e)}return this._imagePromise.then((async t=>{if(this._imagePromise=null,!this.destroyed){for(const e of this.container.children)t.includes(e)||e.fadeOut().then((()=>{e.remove()}));for(const e of t)this.container.addChild(e),e.fadeIn()}})).catch((t=>{throw this._imagePromise=null,t}))}),5e3)}destroy(){}get updating(){return null!==this._imagePromise}updateExports(t){for(const e of this.container.children){if(!e.visible||!e.stage)return;t(e)?console.error("ExportStrategy.updateExports doesn't support promise yet"):(e.invalidateTexture(),e.requestRender())}}_export(t,e,i,o,r,s){return Promise.resolve().then((()=>this.fetchSource(t,Math.floor(e*r),Math.floor(i*r),{rotation:o,pixelRatio:r,signal:s}))).then((i=>{const s=new Bitmap.e(i,"additive");return s.x=t.xmin,s.y=t.ymax,s.resolution=t.width/e,s.rotation=o,s.pixelRatio=r,s}))}_singleExport(t,e,i,o,r){!function u(t,n,o,r){const[u,a]=n,[s,c]=r,i=.5*o;return t[0]=u-i*s,t[1]=a-i*c,t[2]=u+i*s,t[3]=a+i*c,t}(ExportStrategy_u,t.center,t.resolution,e);const s=new Extent.Z(ExportStrategy_u[0],ExportStrategy_u[1],ExportStrategy_u[2],ExportStrategy_u[3],t.spatialReference);return this._export(s,e[0],e[1],i,o,r).then((t=>[t]))}_tiledExport(t,e,i,o,r){const s=TileInfo.Z.create({size:e,spatialReference:t.spatialReference,scales:[t.scale]}),p=new TileInfoView.Z(s),m=p.getTileCoverage(t);if(!m)return null;const h=[];return m.forEach(((s,n,m,l)=>{f.set(s,n,m,l),p.getTileBounds(ExportStrategy_u,f);const d=new Extent.Z(ExportStrategy_u[0],ExportStrategy_u[1],ExportStrategy_u[2],ExportStrategy_u[3],t.spatialReference);h.push(this._export(d,e,e,i,o,r))})),Promise.all(h)}};(0,tslib_es6._)([(0,property.Cb)()],y.prototype,"_imagePromise",void 0),(0,tslib_es6._)([(0,property.Cb)()],y.prototype,"container",void 0),(0,tslib_es6._)([(0,property.Cb)()],y.prototype,"fetchSource",void 0),(0,tslib_es6._)([(0,property.Cb)()],y.prototype,"hidpi",void 0),(0,tslib_es6._)([(0,property.Cb)()],y.prototype,"imageMaxWidth",void 0),(0,tslib_es6._)([(0,property.Cb)()],y.prototype,"imageMaxHeight",void 0),(0,tslib_es6._)([(0,property.Cb)()],y.prototype,"imageRotationSupported",void 0),(0,tslib_es6._)([(0,property.Cb)()],y.prototype,"imageNormalizationSupported",void 0),(0,tslib_es6._)([(0,property.Cb)()],y.prototype,"requestUpdate",void 0),(0,tslib_es6._)([(0,property.Cb)()],y.prototype,"updating",null),y=(0,tslib_es6._)([(0,subclass.j)("esri.views.2d.layers.support.ExportStrategy")],y);const ExportStrategy=y},18196:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{r:()=>n});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(56140),_core_maybe_js__WEBPACK_IMPORTED_MODULE_13__=(__webpack_require__(95830),__webpack_require__(59472)),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__=(__webpack_require__(36544),__webpack_require__(68055),__webpack_require__(79881)),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(87566),_core_Error_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(32656),_geometry_Point_js__WEBPACK_IMPORTED_MODULE_9__=(__webpack_require__(10923),__webpack_require__(57002),__webpack_require__(86035),__webpack_require__(61106)),_layers_support_commonProperties_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(18152),_tasks_support_Query_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(31518),_support_popupUtils_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(21707);const n=n=>{let c=class extends n{constructor(){super(...arguments),this.view=null}async fetchPopupFeatures(e,o){const{layer:t}=this;if(!e)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_5__.Z("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:t});const{popupEnabled:i}=t,n=(0,_support_popupUtils_js__WEBPACK_IMPORTED_MODULE_12__.V)(t,o);if(!i||!(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_13__.pC)(n))throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_5__.Z("imagerylayerview:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:i,popupTemplate:n});const c=await n.getRequiredFields(),m=new _tasks_support_Query_js__WEBPACK_IMPORTED_MODULE_11__.Z;m.geometry=e,m.outFields=c,m.outSpatialReference=e.spatialReference;const l=this.view.resolution,y="2d"===this.view.type?new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_9__.Z(l,l,this.view.spatialReference):new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_9__.Z(.5*l,.5*l,this.view.spatialReference),{returnTopmostRaster:d,showNoDataRecords:w}=n.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},h={returnDomainValues:!0,returnTopmostRaster:d,pixelSize:y,showNoDataRecords:w};return t.queryVisibleRasters(m,h).then((e=>e))}canResume(){var e;return!(!super.canResume()||null!=(e=this.timeExtent)&&e.isEmpty)}};return(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_14__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)()],c.prototype,"layer",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_14__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)()],c.prototype,"suspended",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_14__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)(_layers_support_commonProperties_js__WEBPACK_IMPORTED_MODULE_10__.qG)],c.prototype,"timeExtent",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_14__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)()],c.prototype,"view",void 0),c=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_14__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_4__.j)("esri.views.layers.ImageryLayerView")],c),c}},21707:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{V:()=>d,e:()=>i});var _core_maybe_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(59472),_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4665);async function i(i,d=i.popupTemplate){if(!(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_1__.pC)(d))return[];const o=await d.getRequiredFields(i.fields),{lastEditInfoEnabled:s}=d,{objectIdField:u,typeIdField:a,globalIdField:n,relationships:f}=i;if(o.includes("*"))return["*"];const r=s?await(0,_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_0__.CH)(i):[],m=(0,_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_0__.Q0)(i.fields,[...o,...r]);return a&&m.push(a),m&&u&&(0,_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_0__.cT)(i.fields,u)&&-1===m.indexOf(u)&&m.push(u),m&&n&&(0,_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_0__.cT)(i.fields,n)&&-1===m.indexOf(n)&&m.push(n),f&&f.forEach((e=>{const{keyField:p}=e;m&&p&&(0,_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_0__.cT)(i.fields,p)&&-1===m.indexOf(p)&&m.push(p)})),m}function d(p,l){return p.popupTemplate?p.popupTemplate:(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_1__.pC)(l)&&l.defaultPopupTemplateEnabled&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_1__.pC)(p.defaultPopupTemplate)?p.defaultPopupTemplate:null}}}]);
//# sourceMappingURL=9813.d6669fce.iframe.bundle.js.map