"use strict";(self.webpackChunkreact_arcgis_wmws=self.webpackChunkreact_arcgis_wmws||[]).push([[1673],{71673:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{previewSymbol2D:()=>j});var _core_Error_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(70375),_Color_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(30936),_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(95550),_gfxUtils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(89298),_previewUtils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(83773),_renderUtils_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5840);const m="picture-fill",g=120,b=document.createElement("canvas");function x(e,t){const a=b.getContext("2d"),l=[];return t&&(t.weight&&l.push(t.weight),t.size&&l.push(t.size+"px"),t.family&&l.push(t.family)),a.font=l.join(" "),a.measureText(e).width}function z(e){if(0===e.length)return 0;if(e.length>2){const t=(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_5__.Wz)(1),a=parseFloat(e);switch(e.slice(-2)){case"px":return a;case"pt":return a*t;case"in":return 72*a*t;case"pc":return 12*a*t;case"mm":return 2.8346456692913384*a*t;case"cm":return 28.346456692913385*a*t}}return parseFloat(e)}function j(l,b){var k,L;const j=null!=(null==b?void 0:b.size)?(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_5__.F2)(b.size):null,C=null!=(null==b?void 0:b.maxSize)?(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_5__.F2)(b.maxSize):null,F=null!=(null==b?void 0:b.opacity)?b.opacity:null,S=null!=(null==b?void 0:b.rotation)?b.rotation:"angle"in l?l.angle:null,E=(0,_gfxUtils_js__WEBPACK_IMPORTED_MODULE_2__._M)(l);let P=(0,_gfxUtils_js__WEBPACK_IMPORTED_MODULE_2__.mx)(l);if(E&&!P){const e="type"in E?null:new _Color_js__WEBPACK_IMPORTED_MODULE_1__.Z(E);"#ffffff"===(e?e.toHex():null)&&(P={color:"#bdc3c7",width:.75})}const U={shape:null,fill:null,stroke:P,offset:[0,0]};null!=(k=P)&&k.width&&(P.width=Math.min(P.width,80));const q=(null==(L=P)?void 0:L.width)||0;let Z=null!=j&&(null==(null==b?void 0:b.scale)||(null==b?void 0:b.scale)),H=0,T=0,A=!1;switch(l.type){case"simple-marker":{const e=l.style,t=Math.min(null!=j?j:(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_5__.F2)(l.size),C||g);switch(H=t,T=t,e){case"circle":U.shape={type:"circle",cx:0,cy:0,r:.5*t},Z||(H+=q,T+=q);break;case"cross":U.shape={type:"path",path:[{command:"M",values:[0,.5*T]},{command:"L",values:[H,.5*T]},{command:"M",values:[.5*H,0]},{command:"L",values:[.5*H,T]}]};break;case"diamond":U.shape={type:"path",path:[{command:"M",values:[0,.5*T]},{command:"L",values:[.5*H,0]},{command:"L",values:[H,.5*T]},{command:"L",values:[.5*H,T]},{command:"Z",values:[]}]},Z||(H+=q,T+=q);break;case"square":U.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[H,0]},{command:"L",values:[H,T]},{command:"L",values:[0,T]},{command:"Z",values:[]}]},Z||(H+=q,T+=q),S&&(A=!0);break;case"triangle":U.shape={type:"path",path:[{command:"M",values:[.5*H,0]},{command:"L",values:[H,T]},{command:"L",values:[0,T]},{command:"Z",values:[]}]},Z||(H+=q,T+=q),S&&(A=!0);break;case"x":U.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[H,T]},{command:"M",values:[H,0]},{command:"L",values:[0,T]}]},S&&(A=!0);break;case"path":U.shape={type:"path",path:l.path||""},Z||(H+=q,T+=q),S&&(A=!0),Z=!0}break}case"simple-line":{const e=Math.min(null!=j?j:q,C||80),t=e>22?2*e:40;P.width=e,H=t,T=e,U.shape={type:"path",path:[{command:"M",values:[0,T]},{command:"L",values:[H,T]}]};break}case m:case"simple-fill":H=Math.min(null!=j?j:22,C||g)+q,T=H,Z=!0,U.shape="object"==typeof(null==b?void 0:b.symbolConfig)&&null!=b&&b.symbolConfig.isSquareFill?_previewUtils_js__WEBPACK_IMPORTED_MODULE_3__.JZ.squareFill[0]:_previewUtils_js__WEBPACK_IMPORTED_MODULE_3__.JZ.fill[0];break;case"picture-marker":{let e=(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_5__.F2)(l.width),t=(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_5__.F2)(l.height);const n=Math.max(e,t),o=e/t;e=o<=1?Math.ceil(n*o):n,t=o<=1?n:Math.ceil(n/o),H=Math.min(null!=j?j:e,C||g),T=Math.min(null!=j?j:t,C||g),U.shape={type:"image",x:-Math.round(H/2),y:-Math.round(T/2),width:H,height:T,src:l.url||""},S&&(A=!0);break}case"text":{const e=l,t=e.text||"Aa",n=e.font,o=Math.min(null!=j?j:(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_5__.F2)(n.size),C||g),s=x(t,{weight:n.weight,size:o,family:n.family}),i=/[\uE600-\uE6FF]/.test(t);H=i?o:s,T=o;let r=.25*z((n?o:0).toString());i&&(r+=5),U.shape={type:"text",text:t,x:0,y:r,align:"middle",decoration:n&&n.decoration,rotated:e.rotated,kerning:e.kerning},U.font=n&&{size:o,style:n.style,decoration:n.decoration,weight:n.weight,family:n.family};break}}if(!U.shape)return Promise.reject(new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__.Z("symbolPreview: renderPreviewHTML2D","symbol not supported."));const D=E,R=l.color;let B=null;return D&&"pattern"===D.type&&R&&l.type!==m?B=(0,_gfxUtils_js__WEBPACK_IMPORTED_MODULE_2__.Od)(D.src,R.toCss(!0)).then((e=>(D.src=e,U.fill=D,U))):(U.fill=E,B=Promise.resolve(U)),B.then((e=>{const t=[[e]];if("object"==typeof(null==b?void 0:b.symbolConfig)&&null!=b&&b.symbolConfig.applyColorModulation){const a=.6*H;t.unshift([{...e,offset:[-a,0],fill:(0,_previewUtils_js__WEBPACK_IMPORTED_MODULE_3__.dc)(E,-.3)}]),t.push([{...e,offset:[a,0],fill:(0,_previewUtils_js__WEBPACK_IMPORTED_MODULE_3__.dc)(E,.3)}]),H+=2*a}return(0,_renderUtils_js__WEBPACK_IMPORTED_MODULE_4__.w)(t,[H,T],{node:b&&b.node,scale:Z,opacity:F,rotation:S,useRotationSize:A})}))}}}]);