(self.webpackChunkreact_arcgis_wmws=self.webpackChunkreact_arcgis_wmws||[]).push([[8152],{87040:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{q:()=>r});var r=(0,__webpack_require__(71012).c)((function(o){var r;void 0!==(r=function(){function r(o,n,a,f,i){for(;f>a;){if(f-a>600){var c=f-a+1,e=n-a+1,h=Math.log(c),u=.5*Math.exp(2*h/3),s=.5*Math.sqrt(h*u*(c-u)/c)*(e-c/2<0?-1:1);r(o,n,Math.max(a,Math.floor(n-e*u/c+s)),Math.min(f,Math.floor(n+(c-e)*u/c+s)),i)}var M=o[n],m=a,v=f;for(t(o,a,n),i(o[f],M)>0&&t(o,a,f);m<v;){for(t(o,m,v),m++,v--;i(o[m],M)<0;)m++;for(;i(o[v],M)>0;)v--}0===i(o[a],M)?t(o,a,v):t(o,++v,f),v<=n&&(a=v+1),n<=v&&(f=v-1)}}function t(o,r,t){var n=o[r];o[r]=o[t],o[t]=n}function n(o,r){return o<r?-1:o>r?1:0}return function o(o,t,a,f,i){r(o,t,a||0,f||o.length-1,i||n)}}())&&(o.exports=r)}))},24179:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";function n(n,t){return n?t?4:3:t?3:2}function t(t,I,o,u,l){if(!I||!I.lengths.length)return null;const N="upperLeft"===(null==l?void 0:l.originPosition)?-1:1;t.lengths.length&&(t.lengths.length=0),t.coords.length&&(t.coords.length=0);const s=t.coords,c=[],f=o?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:i,coords:T}=I,h=n(o,u);let g=0;for(const n of i){const t=e(f,T,g,n,o,u,N);t&&c.push(t),g+=n*h}if(c.sort(((n,t)=>{let e=N*n[2]-N*t[2];return 0===e&&o&&(e=n[4]-t[4]),e})),c.length){let n=6*c[0][2];s[0]=c[0][0]/n,s[1]=c[0][1]/n,o&&(n=6*c[0][4],s[2]=0!==n?c[0][3]/n:0),(s[0]<f[0]||s[0]>f[1]||s[1]<f[2]||s[1]>f[3]||o&&(s[2]<f[4]||s[2]>f[5]))&&(s.length=0)}if(!s.length){const n=I.lengths[0]?r(T,0,i[0],o,u):null;if(!n)return null;s[0]=n[0],s[1]=n[1],o&&n.length>2&&(s[2]=n[2])}return t}function e(t,e,r,I,o,u,l=1){const N=n(o,u);let s=r,c=r+N,f=0,i=0,T=0,h=0,g=0;for(let n=0,b=I-1;n<b;n++,s+=N,c+=N){const n=e[s],r=e[s+1],I=e[s+2],u=e[c],l=e[c+1],N=e[c+2];let E=n*l-u*r;h+=E,f+=(n+u)*E,i+=(r+l)*E,o&&(E=n*N-u*I,T+=(I+N)*E,g+=E),n<t[0]&&(t[0]=n),n>t[1]&&(t[1]=n),r<t[2]&&(t[2]=r),r>t[3]&&(t[3]=r),o&&(I<t[4]&&(t[4]=I),I>t[5]&&(t[5]=I))}if(h*l>0&&(h*=-1),g*l>0&&(g*=-1),!h)return null;const E=[f,i,.5*h];return o&&(E[3]=T,E[4]=.5*g),E}function r(t,e,r,N,s){const c=n(N,s);let f=e,i=e+c,T=0,h=0,g=0,E=0;for(let n=0,b=r-1;n<b;n++,f+=c,i+=c){const n=t[f],e=t[f+1],r=t[f+2],s=t[i],c=t[i+1],b=t[i+2],m=N?o(n,e,r,s,c,b):I(n,e,s,c);if(m)if(T+=m,N){const t=l(n,e,r,s,c,b);h+=m*t[0],g+=m*t[1],E+=m*t[2]}else{const t=u(n,e,s,c);h+=m*t[0],g+=m*t[1]}}return T>0?N?[h/T,g/T,E/T]:[h/T,g/T]:r>0?N?[t[e],t[e+1],t[e+2]]:[t[e],t[e+1]]:null}function I(n,t,e,r){const I=e-n,o=r-t;return Math.sqrt(I*I+o*o)}function o(n,t,e,r,I,o){const u=r-n,l=I-t,N=o-e;return Math.sqrt(u*u+l*l+N*N)}function u(n,t,e,r){return[n+.5*(e-n),t+.5*(r-t)]}function l(n,t,e,r,I,o){return[n+.5*(r-n),t+.5*(I-t),e+.5*(o-e)]}__webpack_require__.d(__webpack_exports__,{Y:()=>t})},70929:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(56140),_core_maybe_js__WEBPACK_IMPORTED_MODULE_15__=(__webpack_require__(95830),__webpack_require__(59472)),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__=(__webpack_require__(36544),__webpack_require__(68055),__webpack_require__(79881)),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(87566),_core_watchUtils_js__WEBPACK_IMPORTED_MODULE_8__=(__webpack_require__(10923),__webpack_require__(57002),__webpack_require__(86035),__webpack_require__(80621)),_graphics_graphicUtils_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(74218),_LayerView3D_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(9355),_layers_LayerView_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(48164),_support_projectExtentUtils_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(36868),_graphics_Graphics3DFrustumVisibility_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(84208),_graphics_Graphics3DGraphicLikeLayerView_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(79507);let g=class extends((0,_LayerView3D_js__WEBPACK_IMPORTED_MODULE_10__.A)(_layers_LayerView_js__WEBPACK_IMPORTED_MODULE_11__.Z)){constructor(){super(...arguments),this.frustumVisibility=new _graphics_Graphics3DFrustumVisibility_js__WEBPACK_IMPORTED_MODULE_13__.Z,this.slicePlaneEnabled=!1,this.drapeSourceType=1,this.suspendResumeExtent=null,this.fullExtentInLocalViewSpatialReference=null}initialize(){this._set("graphics3d",new _graphics_Graphics3DGraphicLikeLayerView_js__WEBPACK_IMPORTED_MODULE_14__.Z({owner:this,layer:this.layer,scaleVisibilityEnabled:!0})),this.graphics3d.setup(),this.frustumVisibility.setup(this),this.setupSuspendResumeExtent(),this.updatingHandles.add(this,"fullOpacity",(()=>this.graphics3d.graphicsCore.opacityChange())),this.handles.add(this.layer.on("graphic-update",(i=>this.graphics3d.graphicsCore.graphicUpdateHandler(i))));const i=(0,_support_projectExtentUtils_js__WEBPACK_IMPORTED_MODULE_12__.E)(this).then((i=>{this.fullExtentInLocalViewSpatialReference=i}));i&&this.addResolvingPromise(i),this.layer.internal?this.notifyChange("updating"):this.handles.add((0,_core_watchUtils_js__WEBPACK_IMPORTED_MODULE_8__.LR)(this.view,"basemapTerrain.ready",(()=>this.notifyChange("updating"))))}destroy(){this.frustumVisibility&&(this.frustumVisibility.destroy(),this._set("frustumVisibility",null)),this.graphics3d&&(this.graphics3d.destroy(),this._set("graphics3d",null))}get legendEnabled(){return this.canResume()&&!this.frustumVisibility.suspended}get suspendInfo(){var i;const e={};return(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_15__.pC)(this.graphics3d.scaleVisibility)&&this.graphics3d.scaleVisibility.suspended&&(e.outsideScaleRange=!0),e.outsideOfView=!(null==(i=this.frustumVisibility)||!i.suspended),e}async fetchPopupFeatures(i,e){return(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_15__.pC)(e)?e.clientGraphics:null}notifyGraphicGeometryChanged(i){this.graphics3d.graphicsCore.notifyGraphicGeometryChanged(i)}notifyGraphicVisibilityChanged(i){this.graphics3d.graphicsCore.notifyGraphicVisibilityChanged(i)}get graphics3DGraphics(){return this.graphics3d.graphicsCore.graphics3DGraphics}get graphics3DGraphicsByObjectID(){return this.graphics3d?this.graphics3d.graphicsCore.graphics3DGraphicsByObjectID:null}get symbolUpdateType(){return this.graphics3d.graphicsCore.symbolUpdateType}getGraphicFromGraphicUid(i){return this.graphics3d.getGraphicFromGraphicUid(i)}whenGraphicBounds(i,s){return this.graphics3d.whenGraphicBounds(i,s)}computeAttachmentOrigin(i,s){return this.graphics3d?this.graphics3d.graphicsCore.computeAttachmentOrigin(i,s):null}getSymbolLayerSize(i,s){return this.graphics3d.getSymbolLayerSize(i,s)}queryGraphics(){return Promise.resolve(this.loadedGraphics)}maskOccludee(i){return this.graphics3d.maskOccludee(i)}highlight(i){return this.graphics3d.highlight(i)}canResume(){var i;return super.canResume()&&!(null!=(i=this.graphics3d)&&i.suspended)}isUpdating(){var i,s;return!(!(this.graphics3d&&this.graphics3d.updating||this.frustumVisibility&&this.frustumVisibility.updating)&&(this.layer.internal||null!=(i=this.view)&&null!=(s=i.basemapTerrain)&&s.ready))}setupSuspendResumeExtent(){const i=()=>{this.suspendResumeExtent=(0,_graphics_graphicUtils_js__WEBPACK_IMPORTED_MODULE_9__.Go)(this.graphics3d.graphicsCore.computedExtent,this.suspendResumeExtent,1.2,this.graphics3d.graphicsCore.extentPadding),this.frustumVisibility.setExtent(this.suspendResumeExtent)};(0,_core_watchUtils_js__WEBPACK_IMPORTED_MODULE_8__.S1)(this.graphics3d.graphicsCore,"computedExtent",(()=>i()),!0),(0,_core_watchUtils_js__WEBPACK_IMPORTED_MODULE_8__.YP)(this.graphics3d.graphicsCore,"extentPadding",(()=>i()),!0)}get performanceInfo(){return{displayedNumberOfFeatures:this.loadedGraphics.length,maximumNumberOfFeatures:-1,totalNumberOfFeatures:-1,nodes:0,core:null,updating:this.updating,elevationUpdating:this.graphics3d.elevationAlignment.updating,visibilityFrustum:!this.frustumVisibility.suspended}}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_16__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({aliasOf:"layer.graphics"})],g.prototype,"loadedGraphics",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_16__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({readOnly:!0})],g.prototype,"suspended",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_16__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({readOnly:!0})],g.prototype,"legendEnabled",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_16__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({readOnly:!0})],g.prototype,"updating",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_16__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)()],g.prototype,"layer",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_16__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({readOnly:!0})],g.prototype,"frustumVisibility",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_16__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({readOnly:!0})],g.prototype,"graphics3d",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_16__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({type:Boolean})],g.prototype,"slicePlaneEnabled",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_16__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({readOnly:!0})],g.prototype,"suspendInfo",null),g=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_16__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_4__.j)("esri.views.3d.layers.GraphicsLayerView3D")],g);const __WEBPACK_DEFAULT_EXPORT__=g},65437:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>Graphics3DElevationAlignment});var tslib_es6=__webpack_require__(56140),maybe=(__webpack_require__(95830),__webpack_require__(59472)),property=(__webpack_require__(36544),__webpack_require__(68055),__webpack_require__(79881)),subclass=__webpack_require__(87566),Accessor=(__webpack_require__(10923),__webpack_require__(57002),__webpack_require__(86035),__webpack_require__(82677)),Evented=__webpack_require__(35470),Handles=__webpack_require__(59691),Scheduler=__webpack_require__(35430),PooledArray=__webpack_require__(62698),aaBoundingRect=__webpack_require__(50897);class c{constructor(){this.extents=new PooledArray.Z({allocator:t=>t||(0,aaBoundingRect.Ue)()}),this.tempExtent=(0,aaBoundingRect.Ue)(),this.dirty=!1}get empty(){return 0===this.extents.length}clear(){this.extents.clear()}add(t){this.contains(t)||(this.removeContained(t),(0,aaBoundingRect.t8)(this.extents.pushNew(),t),this.dirty=!0)}pop(){return this.dirty&&this.mergeTight(),this.extents.pop()}merge(t){return this.mergeTight(t),t.hasProgressed}mergeTight(t=Scheduler.G5){const e=this.extents,o=new Set;let i=0;for(;i!==e.length;){e.sort(((t,e)=>t[0]-e[0])),i=e.length,o.clear();for(let i=0;i<e.length;++i){if(t.done)return;const h=e.getItemAt(i);for(let t=i+1;t<e.length;++t){const r=e.getItemAt(t);if(r[0]>=h[2])break;o.add(r)}o.forEach((i=>{if(h===i)return;if(i[2]<=h[0])return void o.delete(i);const c=(0,aaBoundingRect.SO)(h),m=(0,aaBoundingRect.SO)(i),d=this.tempExtent;(0,aaBoundingRect.jn)(h,i,d);const g=c+m;((0,aaBoundingRect.SO)(d)-g)/g<.05&&((0,aaBoundingRect.t8)(h,d),o.delete(i),e.remove(i),t.madeProgress())})),o.add(h)}}this.dirty=!1}contains(t){return this.extents.some((e=>(0,aaBoundingRect.r3)(e,t)))}removeContained(t){this.extents.filterInPlace((e=>!(0,aaBoundingRect.r3)(t,e)))}get test(){const t=this;return{containsPoint:e=>t.extents.some((t=>(0,aaBoundingRect.BD)(t,e)))}}}let p=class extends Accessor.Z{constructor(){super(...arguments),this.dirtyExtents=new c,this.globalDirty=!1,this.dirtyGraphicsSet=new Set,this.handles=new Handles.Z,this.updateElevation=!1,this.layerView=null,this.graphicsCore=null,this.events=new Evented.Z}get updating(){return this.needsUpdate()}setup(e,t,i,s){this.layerView=e,this.queryGraphicUIDsInExtent=t,this.graphicsCore=i,this.elevationProvider=s;const r=this.layerView.view.resourceController.scheduler;this.handles.add([s.on("elevation-change",(e=>this._elevationChanged(e))),this.layerView.watch("suspended",(()=>this.suspendedChange())),r.registerTask(Scheduler.iQ.ELEVATION_ALIGNMENT,(e=>this.update(e)),(()=>this.needsUpdate()))])}destroy(){this.dirtyGraphicsSet.clear(),this.handles.destroy(),this.handles=null,this.layerView=null,this.graphicsCore=null,this.queryGraphicUIDsInExtent=null}clear(){this.dirtyGraphicsSet.clear(),this.notifyChange("updating")}suspendedChange(){!0===this.layerView.suspended?this.updateElevation=!1:!1===this.layerView.suspended&&this.updateElevation&&(this.globalDirty=!0,this.notifyChange("updating"))}elevationInfoChange(){this.globalDirty=!0,this.notifyChange("updating")}needsUpdate(){return this.dirtyGraphicsSet.size>0||this.dirtyExtents&&!this.dirtyExtents.empty||this.globalDirty}update(e){for(this.globalDirty&&(this.markAllGraphicsElevationDirty(),this.globalDirty=!1,e.madeProgress()),e.run((()=>this.dirtyExtents.merge(e)));this.needsUpdate()&&!e.done;)this._updateDirtyGraphics(e),this._updateDirtyExtents(e);this.layerView.view.deconflictor.setDirty(),this.notifyChange("updating")}_updateDirtyGraphics(e){const i=this.layerView.view.renderCoordsHelper,s=this.graphicsCore.asyncUpdates;for(const r of this.dirtyGraphicsSet.keys()){const a=this.graphicsCore.getGraphics3DGraphicById(r);if(this.dirtyGraphicsSet.delete(r),(0,maybe.pC)(a)&&(a.alignWithElevation(this.elevationProvider,i,s),e.madeProgress()),e.done)return}}_updateDirtyExtents(e){for(;!this.dirtyExtents.empty&&!e.done;){const i=this.dirtyExtents.pop(),s=this.elevationProvider.spatialReference;this.events.emit("invalidate-elevation",{extent:i,spatialReference:s}),this.queryGraphicUIDsInExtent(i,s,(e=>{const i=this.graphicsCore.getGraphics3DGraphicById(e);(0,maybe.pC)(i)&&i.needsElevationUpdates()&&this.dirtyGraphicsSet.add(e)})),e.madeProgress()}}markAllGraphicsElevationDirty(){this.dirtyExtents.clear(),this.dirtyGraphicsSet.clear(),this.graphicsCore.graphics3DGraphics.forEach(((e,t)=>this.dirtyGraphicsSet.add(t)))}_elevationChanged(e){if("scene"===e.context&&(!this.graphicsCore.layer.elevationInfo||"relative-to-scene"!==this.graphicsCore.layer.elevationInfo.mode))return;const{extent:t,spatialReference:i}=e;if(this.layerView.suspended){if(!this.updateElevation){const e=this.graphicsCore.computedExtent;e&&t[2]>e.xmin&&t[0]<e.xmax&&t[3]>e.ymin&&t[1]<e.ymax&&(this.updateElevation=!0)}this.events.emit("invalidate-elevation",{extent:t,spatialReference:i})}else t[0]===-1/0?this.globalDirty=!0:this.dirtyExtents.add(t),this.notifyChange("updating")}};(0,tslib_es6._)([(0,property.Cb)({readOnly:!0})],p.prototype,"updating",null),p=(0,tslib_es6._)([(0,subclass.j)("esri.views.3d.layers.graphics.Graphics3DElevationAlignment")],p);const Graphics3DElevationAlignment=p},84208:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(56140),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__=(__webpack_require__(95830),__webpack_require__(36544),__webpack_require__(68055),__webpack_require__(79881)),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(87566),_core_Accessor_js__WEBPACK_IMPORTED_MODULE_8__=(__webpack_require__(10923),__webpack_require__(57002),__webpack_require__(86035),__webpack_require__(82677)),_core_Handles_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(59691),_core_watchUtils_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(80621),_geometry_projectionEllipsoid_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(89333),_support_Scheduler_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(35430),_support_FrustumExtentIntersection_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(1372);let u=class extends _core_Accessor_js__WEBPACK_IMPORTED_MODULE_8__.Z{constructor(){super(...arguments),this.suspended=!1,this.extent=null,this.extentIntersectionDirty=!0,this._isVisibleBelowSurface=!1,this.handles=new _core_Handles_js__WEBPACK_IMPORTED_MODULE_9__.Z,this.layerView=null,this.updating=!0}setup(e){this.layerView=e,this.extentIntersection=new _support_FrustumExtentIntersection_js__WEBPACK_IMPORTED_MODULE_13__.q({renderCoordsHelper:e.view.renderCoordsHelper});const t=e.view,s=t.basemapTerrain,i=t.resourceController.scheduler;this.handles.add([t.on("resize",(()=>this.viewChange())),t.state.watch("camera",(()=>this.viewChange()),!0),i.registerTask(_support_Scheduler_js__WEBPACK_IMPORTED_MODULE_12__.iQ.FRUSTUM_VISIBILITY,(()=>this.update()),(()=>this.updating)),s.on("elevation-bounds-change",(()=>this.elevationBoundsChange()))]),"local"===t.viewingMode?this.isVisibleBelowSurface=!0:this.handles.add([(0,_core_watchUtils_js__WEBPACK_IMPORTED_MODULE_10__.S1)(s,["opacity","wireframe"],(()=>this.updateIsVisibleBelowSurface())),(0,_core_watchUtils_js__WEBPACK_IMPORTED_MODULE_10__.S1)(t,"map.ground.navigationConstraint.type",(()=>this.updateIsVisibleBelowSurface()))])}destroy(){this.layerView=null,this.extent=null,this.extentIntersection=null,this.handles&&(this.handles.destroy(),this.handles=null)}_setDirty(){this.updating||this._set("updating",!0)}setExtent(e){this.extent=e,this.extentIntersectionDirty=!0,this._setDirty()}viewChange(){this._setDirty()}elevationBoundsChange(){this._setDirty(),this.extentIntersectionDirty=!0}set isVisibleBelowSurface(e){this._isVisibleBelowSurface=e,this._setDirty(),this.extentIntersectionDirty=!0}updateIsVisibleBelowSurface(){const e=this.layerView.view,t=e.basemapTerrain,s="local"===e.viewingMode,i=e.map.ground&&e.map.ground.navigationConstraint&&"none"===e.map.ground.navigationConstraint.type;this.isVisibleBelowSurface=s||!t.opaque||i}updateExtentIntersection(){if(!this.extentIntersectionDirty)return;this.extentIntersectionDirty=!1;const e=this.layerView.view;let t;if(this._isVisibleBelowSurface)t=-.3*(0,_geometry_projectionEllipsoid_js__WEBPACK_IMPORTED_MODULE_11__.Iu)(e.spatialReference).radius;else{const{min:s,max:i}=e.basemapTerrain.elevationBounds;t=s-Math.max(1,(i-s)*(1.2-1))}this.extentIntersection.update(this.extent,e.spatialReference,t)}update(){if(this._set("updating",!1),!this.extent)return void this._set("suspended",!1);this.updateExtentIntersection();const e=this.layerView.view.frustum,t=(0,_geometry_projectionEllipsoid_js__WEBPACK_IMPORTED_MODULE_11__.Iu)(this.layerView.view.spatialReference).radius;this._set("suspended",!this.extentIntersection.isVisibleInFrustum(e,t))}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_14__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({readOnly:!0})],u.prototype,"suspended",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_14__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({readOnly:!0})],u.prototype,"updating",void 0),u=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_14__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_4__.j)("esri.views.3d.layers.graphics.Graphics3DFrustumVisibility")],u);const __WEBPACK_DEFAULT_EXPORT__=u},79507:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(56140),_core_maybe_js__WEBPACK_IMPORTED_MODULE_24__=(__webpack_require__(95830),__webpack_require__(59472)),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__=(__webpack_require__(36544),__webpack_require__(68055),__webpack_require__(79881)),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(87566),_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_8__=(__webpack_require__(10923),__webpack_require__(57002),__webpack_require__(86035),__webpack_require__(39105)),_core_Accessor_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(82677),_core_Collection_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(28293),_Graphic_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(15988),_core_Handles_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(59691),_layers_Layer_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(56700),_core_watchUtils_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(80621),_core_accessorSupport_diffUtils_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(23229),_tasks_support_Query_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(31518),_support_WatchUpdatingTracking_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(45671),_layers_graphics_hydratedFeatures_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(58722),_graphicUtils_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(74218),_constants_js__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(93293),_Graphics3DCore_js__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(56656),_Graphics3DScaleVisibility_js__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(16861),_Graphics3DElevationAlignment_js__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(65437),_Graphics3DObjectStates_js__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(36871);let v=class extends _core_Accessor_js__WEBPACK_IMPORTED_MODULE_9__.Z{constructor(t){super(t),this.graphicsCore=null,this.elevationAlignment=new _Graphics3DElevationAlignment_js__WEBPACK_IMPORTED_MODULE_23__.Z,this.watchUpdatingTracking=new _support_WatchUpdatingTracking_js__WEBPACK_IMPORTED_MODULE_17__.t,this.handles=new _core_Handles_js__WEBPACK_IMPORTED_MODULE_12__.Z,this.suspendResumeExtent=null}normalizeCtorArgs(t){let e=null;t.scaleVisibilityEnabled&&(delete(t={...t}).scaleVisibilityEnabled,e=new _Graphics3DScaleVisibility_js__WEBPACK_IMPORTED_MODULE_22__.Z);const i=new _Graphics3DCore_js__WEBPACK_IMPORTED_MODULE_21__.w({owner:t.owner,layer:t.layer,preferredUpdatePolicy:0,graphicSymbolSupported:!0});return{...t,graphicsCore:i,scaleVisibility:e}}initialize(){const t=this.scaleVisibility;(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_24__.pC)(t)&&"minScale"in this.layer&&this.watchUpdatingTracking.add(this.layer,"scaleRangeId",(()=>t.layerMinMaxScaleChangeHandler())),"elevationInfo"in this.layer&&this.watchUpdatingTracking.add(this.layer,"elevationInfo",((t,e)=>{(0,_core_accessorSupport_diffUtils_js__WEBPACK_IMPORTED_MODULE_15__.Hg)(t,e)&&this.watchUpdatingTracking.addPromise(this.graphicsCore.elevationInfoChange())}))}async setup(){const t=(t,e,i)=>this.graphicsCore.spatialIndex.queryGraphicUIDsInExtent(t,e,i);if(this.elevationAlignment.setup(this.owner,t,this.graphicsCore,this.view.elevationProvider),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_24__.pC)(this.scaleVisibility)&&"minScale"in this.layer){const e=this.owner.view.basemapTerrain;this.scaleVisibility.setup(this.owner,this.layer,t,this.graphicsCore,e)}this._set("objectStates",new _Graphics3DObjectStates_js__WEBPACK_IMPORTED_MODULE_25__.d(this.graphicsCore));try{await this.graphicsCore.setup({elevationAlignment:this.elevationAlignment,scaleVisibility:this.scaleVisibility,objectStates:this.objectStates})}catch(i){if((0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_8__.D_)(i))return;throw i}this.destroyed||(this.handles.add(this.view.watch("clippingArea",(()=>this.updateClippingExtent()),!0)),this.updateClippingExtent(),this.setupSuspendResumeExtent(),this.graphicsCore.startCreateGraphics())}destroy(){this.handles=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_24__.SC)(this.handles),this.watchUpdatingTracking.destroy(),this._set("elevationAlignment",(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_24__.SC)(this.elevationAlignment)),this._set("scaleVisibility",(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_24__.SC)(this.scaleVisibility)),this._set("objectStates",(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_24__.SC)(this.objectStates)),this._set("graphicsCore",(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_24__.SC)(this.graphicsCore))}get suspended(){return!(!(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_24__.pC)(this.scaleVisibility)||!this.scaleVisibility.suspended)}get updating(){var t,i;return!!(null!=(t=this.graphicsCore)&&t.updating||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_24__.pC)(this.scaleVisibility)&&this.scaleVisibility.updating||null!=(i=this.watchUpdatingTracking)&&i.updating)}getGraphicFromGraphicUid(t){if(this.owner.loadedGraphics){const e=this.owner.loadedGraphics.find((e=>e.uid===t));if(e){const t=this.layer instanceof _layers_Layer_js__WEBPACK_IMPORTED_MODULE_13__.Z?this.layer:null;return(0,_layers_graphics_hydratedFeatures_js__WEBPACK_IMPORTED_MODULE_18__.mW)(e,t)}}}whenGraphicBounds(t,e){return this.graphicsCore?this.graphicsCore.whenGraphicBounds(t,e):Promise.reject()}computeAttachmentOrigin(t,e){return this.graphicsCore?this.graphicsCore.computeAttachmentOrigin(t,e):null}getSymbolLayerSize(t,e){return this.graphicsCore?this.graphicsCore.getSymbolLayerSize(t,e):null}maskOccludee(t){const{set:e,handle:i}=this.objectStates.acquireSet(1,null);return this.objectStates.setUid(e,t.uid),i}highlight(t){if(t instanceof _tasks_support_Query_js__WEBPACK_IMPORTED_MODULE_16__.Z)return x;if("number"==typeof t)return this.highlight([t]);if(t instanceof _Graphic_js__WEBPACK_IMPORTED_MODULE_11__.Z)return this.highlight([t]);if(t instanceof _core_Collection_js__WEBPACK_IMPORTED_MODULE_10__.Z&&(t=t.toArray()),Array.isArray(t)&&t.length>0){if(t[0]instanceof _Graphic_js__WEBPACK_IMPORTED_MODULE_11__.Z){const e=t.map((t=>t.uid)),{set:i,handle:s}=this.objectStates.acquireSet(0,null);return this.objectStates.setUids(i,e),s}if("number"==typeof t[0]){const e=t,{set:i,handle:s}=this.objectStates.acquireSet(0,null);return this.objectStates.setObjectIds(i,e),s}}return x}updateClippingExtent(){const t=this.view.clippingArea;this.graphicsCore.setClippingExtent(t,this.view.spatialReference)&&this.graphicsCore.recreateAllGraphics()}updateSuspendResumeExtent(){(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_24__.Wi)(this.scaleVisibility)||(this.suspendResumeExtent=(0,_graphicUtils_js__WEBPACK_IMPORTED_MODULE_19__.Go)(this.graphicsCore.computedExtent,this.suspendResumeExtent,_constants_js__WEBPACK_IMPORTED_MODULE_20__.ZF,this.graphicsCore.extentPadding),this.scaleVisibility.setExtent(this.suspendResumeExtent))}setupSuspendResumeExtent(){(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_24__.Wi)(this.scaleVisibility)||((0,_core_watchUtils_js__WEBPACK_IMPORTED_MODULE_14__.S1)(this.graphicsCore,"computedExtent",(t=>this.updateSuspendResumeExtent()),!0),this.graphicsCore.watch("extentPadding",(t=>this.updateSuspendResumeExtent())))}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_26__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({constructOnly:!0})],v.prototype,"owner",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_26__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({constructOnly:!0})],v.prototype,"layer",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_26__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({readOnly:!0,aliasOf:"owner.view"})],v.prototype,"view",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_26__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({constructOnly:!0})],v.prototype,"graphicsCore",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_26__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({constructOnly:!0})],v.prototype,"scaleVisibility",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_26__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({readOnly:!0})],v.prototype,"elevationAlignment",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_26__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({readOnly:!0})],v.prototype,"objectStates",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_26__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({readOnly:!0})],v.prototype,"watchUpdatingTracking",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_26__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({readOnly:!0})],v.prototype,"suspended",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_26__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({readOnly:!0})],v.prototype,"updating",null),v=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_26__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_4__.j)("esri.views.3d.layers.graphics.Graphics3DGraphicLikeLayerView")],v);const x={remove(){},pause(){},resume(){}};const __WEBPACK_DEFAULT_EXPORT__=v},36871:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{d:()=>s});var handleUtils=__webpack_require__(5632);class Object3DStateSet_e{constructor(){this.items=[]}addObject(e,t){this.items.push({type:0,objectStateId:t,object:e})}addRenderGeometry(e,t,s){this.items.push({type:1,objectStateId:t,renderGeometry:e,owner:s})}addExternal(e,t){this.items.push({type:2,objectStateId:t,remove:e})}remove(e){for(let t=this.items.length-1;t>=0;--t){const s=this.items[t];s.objectStateId===e&&(this._removeObjectStateItem(s),this.items.splice(t,1))}}removeObject(e){for(let t=this.items.length-1;t>=0;--t){const s=this.items[t];0===s.type&&s.object===e&&(this._removeObjectStateItem(s),this.items.splice(t,1))}}removeRenderGeometry(e){for(let t=this.items.length-1;t>=0;--t){const s=this.items[t];1===s.type&&s.renderGeometry===e&&(this._removeObjectStateItem(s),this.items.splice(t,1))}}removeAll(){this.items.forEach((e=>{this._removeObjectStateItem(e)})),this.items=[]}_removeObjectStateItem(e){switch(e.type){case 0:0===e.objectStateId.channel?e.object.removeHighlight(e.objectStateId):1===e.objectStateId.channel&&e.object.removeOcclude(e.objectStateId);break;case 1:e.owner.removeRenderGeometryObjectState(e.renderGeometry,e.objectStateId);break;case 2:e.remove(e.objectStateId)}}}class e{constructor(e,i){this.stateType=e,this.objectIdField=i,this.objectStateSet=new Object3DStateSet_e,this.ids=new Set,this.paused=!1}hasGraphic(t){if(this.objectIdField){const e=t.graphic.attributes[this.objectIdField];return this.ids.has(e)}return this.ids.has(t.graphic.uid)}}class s{constructor(t){this._graphicsCore=t,this._stateSets=new Array}destroy(){this._stateSets&&this._stateSets.forEach((t=>t.objectStateSet.removeAll())),this._stateSets=null}acquireSet(s,a){const i=new e(s,a);this._stateSets.push(i);const h=(0,handleUtils.kB)((()=>this.releaseSet(i)));return{set:i,handle:h}}releaseSet(t){t.objectStateSet.removeAll();const e=this._stateSets?this._stateSets.indexOf(t):-1;-1!==e&&this._stateSets.splice(e,1)}_addObjectStateSet(t,e){t.addObjectStateSet(e.stateType,e.objectStateSet)}_removeObjectStateSet(t,e){t.removeObjectState(e.objectStateSet)}setUid(t,e){t.ids.add(e);const s=this._graphicsCore.graphics3DGraphics.get(e);s&&this._addObjectStateSet(s,t)}setUids(t,e){e.forEach((e=>this.setUid(t,e)))}setObjectIds(t,e){e.forEach((e=>t.ids.add(e))),this.initializeSet(t)}addGraphic(t){this._stateSets.forEach((e=>{!e.paused&&e.hasGraphic(t)&&this._addObjectStateSet(t,e)}))}removeGraphic(t){this._stateSets.forEach((e=>{e.hasGraphic(t)&&this._removeObjectStateSet(t,e)}))}allGraphicsDeleted(){this._stateSets&&this._stateSets.forEach((t=>t.objectStateSet.removeAll()))}initializeSet(t){const e=this._graphicsCore.graphics3DGraphics;t.objectIdField?e.forEach((e=>{e&&t.hasGraphic(e)&&this._addObjectStateSet(e,t)})):t.ids.forEach((s=>{const a=e.get(s);a&&this._addObjectStateSet(a,t)}))}get test(){return{states:this._stateSets}}}},36868:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{E:()=>t});var _geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(41241),_portal_support_geometryServiceUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(75138);function t(t){const l=t.view.spatialReference,s=t.layer.fullExtent,i=s&&s.spatialReference;return i?i.equals(l)?Promise.resolve(s.clone()):(0,_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_0__.Q8)(i,l)?Promise.resolve((0,_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_0__.iV)(s,l)):t.view.state.isLocal?(0,_portal_support_geometryServiceUtils_js__WEBPACK_IMPORTED_MODULE_1__.projectGeometry)(s,l,t.layer.portalItem).then((e=>!t.destroyed&&e?e:void 0)).catch((()=>null)):Promise.resolve(null):Promise.resolve(null)}}}]);
//# sourceMappingURL=8152.749fe6ad.iframe.bundle.js.map