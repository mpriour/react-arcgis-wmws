"use strict";(self.webpackChunkreact_arcgis_wmws=self.webpackChunkreact_arcgis_wmws||[]).push([[6397],{6397:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(36663),_core_maybe_js__WEBPACK_IMPORTED_MODULE_28__=(__webpack_require__(39994),__webpack_require__(61681)),_core_Logger_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(13802),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__=(__webpack_require__(7283),__webpack_require__(81977)),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(12571),_Graphic_js__WEBPACK_IMPORTED_MODULE_8__=(__webpack_require__(3466),__webpack_require__(12173),__webpack_require__(51876),__webpack_require__(80085)),_support_Scheduler_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(55839),_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(3362),_tasks_support_Query_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(27746),_LayerView3D_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(19654),_support_layerViewUpdatingProperties_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(72035),_layers_support_FeatureFilter_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(37034),_layers_SceneLayerView_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(21808),_i3s_I3SUtil_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(78565),_i3s_I3SGeometryUtil_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(11399),_I3SMeshView3D_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(99380),_i3s_I3SMeshViewFilter_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(19141),_i3s_I3SQueryEngine_js__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(61498),_i3s_I3SQueryFeatureAdapter_js__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(5002),_i3s_I3SQueryFeatureStore_js__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(57602),_support_DefinitionExpressionSceneLayerView_js__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(7933),_support_floorFilterUtils_js__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(80876),_support_PopupSceneLayerView_js__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(44613),_i3s_attributeEditing_js__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(56527),_support_fieldProperties_js__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(3917),_support_SceneLayerViewRequiredFields_js__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(37495);const Q=_core_Logger_js__WEBPACK_IMPORTED_MODULE_1__.Z.getLogger("esri.views.3d.layers.SceneLayerView3D"),q=(0,_support_fieldProperties_js__WEBPACK_IMPORTED_MODULE_26__.v)();let D=class extends((0,_I3SMeshView3D_js__WEBPACK_IMPORTED_MODULE_18__.N)((0,_support_DefinitionExpressionSceneLayerView_js__WEBPACK_IMPORTED_MODULE_23__.l)((0,_support_PopupSceneLayerView_js__WEBPACK_IMPORTED_MODULE_24__.i)((0,_LayerView3D_js__WEBPACK_IMPORTED_MODULE_12__.A)(_layers_SceneLayerView_js__WEBPACK_IMPORTED_MODULE_15__.Z))))){constructor(){super(...arguments),this.lodFactor=1,this.progressiveLoadFactor=1,this._elevationContext="scene",this._isIntegratedMesh=!1,this._supportsLabeling=!0,this._interactiveEditingSessions=new Map,this._queryEngine=null}get filter(){return(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_28__.pC)(this.viewFilter)?this.viewFilter.filter:null}set filter(e){!(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_28__.Wi)(e)&&_i3s_I3SMeshViewFilter_js__WEBPACK_IMPORTED_MODULE_19__.z.checkSupport(e)?(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_28__.pC)(this.viewFilter)?this.viewFilter.filter=e:this.viewFilter=new _i3s_I3SMeshViewFilter_js__WEBPACK_IMPORTED_MODULE_19__.z({filter:e,layerFieldsIndex:this.layer.fieldsIndex,loadAsyncModule:e=>this._loadAsyncModule(e),applyFilters:()=>this._applyFilters(!0),addSqlFilter:(e,t)=>this.addSqlFilter(e,t,this.logError)}):this.viewFilter=null}get requiredFields(){var e,t;return null!=(e=null==(t=this.fieldsHelper)?void 0:t.requiredFields)?e:[]}get floorFilterClause(){const e=(0,_support_floorFilterUtils_js__WEBPACK_IMPORTED_MODULE_29__.c)(this);return(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_28__.pC)(e)?_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_10__.WhereClause.create(e,this.layer.fieldsIndex):null}get lodCrossfadeinDuration(){var e,t;return null!=(e=null==(t=this.view)?void 0:t.qualitySettings.sceneService["3dObject"].lodCrossfadeinDuration)?e:0}get lodCrossfadeoutDuration(){var e,t;return null!=(e=null==(t=this.view)?void 0:t.qualitySettings.sceneService["3dObject"].lodCrossfadeoutDuration)?e:0}get lodCrossfadeUncoveredDuration(){var e,t;return null!=(e=null==(t=this.view)?void 0:t.qualitySettings.sceneService["3dObject"].lodCrossfadeUncoveredDuration)?e:0}initialize(){this.fieldsHelper=new _support_SceneLayerViewRequiredFields_js__WEBPACK_IMPORTED_MODULE_27__.K({layerView:this}),this.updatingHandles.add(this.layer,"rangeInfos",(e=>this._rangeInfosChanged(e)),2),this.updatingHandles.add(this.layer,"renderer",(e=>this.updatingHandles.addPromise(this._rendererChange(e))),2);for(const e of["parsedDefinitionExpression","filter","viewFilter.parsedWhereClause","viewFilter.parsedGeometry","viewFilter.sortedObjectIds","floorFilterClause"])this.updatingHandles.add(this,e,(()=>this._filterChange()));for(const e of["filter","viewFilter.parsedGeometry"])this.updatingHandles.add(this,e,(()=>this._geometryFilterChange()));this.handles.add(this.layer.on("apply-edits",(e=>this.updatingHandles.addPromise(e.result)))),this.handles.add(this.layer.on("edits",(e=>this._handleEdits(e))))}destroy(){this.fieldsHelper=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_28__.SC)(this.fieldsHelper)}_rangeInfosChanged(e){null!=e&&e.length>0&&Q.warn("Unsupported property: rangeInfos are currently only serialized to and from web scenes but do not affect rendering.")}createQuery(){const e={outFields:["*"],returnGeometry:!1,outSpatialReference:this.view.spatialReference};return(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_28__.pC)(this.filter)?this.filter.createQuery(e):new _tasks_support_Query_js__WEBPACK_IMPORTED_MODULE_11__.Z(e)}queryExtent(e,t){return this._ensureQueryEngine().executeQueryForExtent(this._ensureQuery(e),null==t?void 0:t.signal)}queryFeatureCount(e,t){return this._ensureQueryEngine().executeQueryForCount(this._ensureQuery(e),null==t?void 0:t.signal)}queryFeatures(e,t){return this._ensureQueryEngine().executeQuery(this._ensureQuery(e),null==t?void 0:t.signal).then((e=>{if(null==e||!e.features)return e;const t=this.layer;for(const r of e.features)r.layer=t,r.sourceLayer=t;return e}))}queryObjectIds(e,t){return this._ensureQueryEngine().executeQueryForIds(this._ensureQuery(e),null==t?void 0:t.signal)}_ensureQueryEngine(){return this._queryEngine||(this._queryEngine=this._createQueryEngine()),this._queryEngine}_createQueryEngine(){const e=(0,_i3s_I3SGeometryUtil_js__WEBPACK_IMPORTED_MODULE_17__.gz)(this.view.spatialReference,this.view.renderSpatialReference,this._collection);return new _i3s_I3SQueryEngine_js__WEBPACK_IMPORTED_MODULE_20__.Z({layerView:this,task:_support_Scheduler_js__WEBPACK_IMPORTED_MODULE_9__.iQ.FEATURE_QUERY_ENGINE,spatialIndex:new _i3s_I3SQueryFeatureStore_js__WEBPACK_IMPORTED_MODULE_22__.Z({featureAdapter:new _i3s_I3SQueryFeatureAdapter_js__WEBPACK_IMPORTED_MODULE_21__.u({objectIdField:this.layer.objectIdField,attributeStorageInfo:this.layer.attributeStorageInfo,getFeatureExtent:e}),forAllFeatures:(e,t)=>this._forAllFeatures(((t,r,i)=>e({id:t,index:r,meta:i})),t,2),getFeatureExtent:e,sourceSpatialReference:(0,_i3s_I3SUtil_js__WEBPACK_IMPORTED_MODULE_16__.tp)(this.layer),viewSpatialReference:this.view.spatialReference})})}highlight(e){const t=this._highlights;if(e instanceof _tasks_support_Query_js__WEBPACK_IMPORTED_MODULE_11__.Z){const{set:r,handle:i}=t.acquireSet();return this.queryObjectIds(e).then((e=>t.setFeatureIds(r,e))),i}return super.highlight(e)}createInteractiveEditSession(e){return(0,_i3s_attributeEditing_js__WEBPACK_IMPORTED_MODULE_25__.s)(this.attributeEditingContext,e)}_createLayerGraphic(e){const t=new _Graphic_js__WEBPACK_IMPORTED_MODULE_8__.Z(null,null,e);return t.layer=this.layer,t.sourceLayer=this.layer,t}canResume(){return super.canResume()&&(!this._controller||this._controller.rootNodeVisible)}getFilters(){const e=super.getFilters();return this.floorFilterClause&&this.addSqlFilter(e,this.floorFilterClause,this.logError),this.addSqlFilter(e,this.parsedDefinitionExpression,this.logError),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_28__.pC)(this.viewFilter)&&this.viewFilter.addFilters(e,this.view,this._controller.crsIndex,this._collection),e}_ensureQuery(e){return this._addDefinitionExpressionToQuery((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_28__.Wi)(e)?this.createQuery():_tasks_support_Query_js__WEBPACK_IMPORTED_MODULE_11__.Z.from(e))}get attributeEditingContext(){return{sessions:this._interactiveEditingSessions,fieldsIndex:this.layer.fieldsIndex,objectIdField:this._getObjectIdField(),forEachNode:e=>this._forAllNodes((r=>(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_28__.pC)(r)?e(r.node,r.featureIds):null)),attributeStorageInfo:this.i3slayer.attributeStorageInfo,attributeOverrides:this.attributeOverrides,getAttributeData:e=>this.getAttributeData(e),setAttributeData:(e,t)=>this.setAttributeData(e,t),clearMemCache:()=>this.clearMemCache()}}_handleEdits(e){(0,_i3s_attributeEditing_js__WEBPACK_IMPORTED_MODULE_25__.Z)(this.attributeEditingContext,e)}get hasGeometryFilter(){const e=this.viewFilter;return(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_28__.pC)(e)&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_28__.pC)(e.parsedGeometry)}computeNodeFiltering(e){const t=this.viewFilter,i=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_28__.Wi)(t)||t.isMBSGeoemtryVisible(e.mbs,this.view.spatialReference,this._controller.crsIndex);e.filterImpact=i?0:1}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_30__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({aliasOf:"layer"})],D.prototype,"i3slayer",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_30__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)()],D.prototype,"suspended",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_30__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)(_support_layerViewUpdatingProperties_js__WEBPACK_IMPORTED_MODULE_13__.q)],D.prototype,"updatingProgress",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_30__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({type:_layers_support_FeatureFilter_js__WEBPACK_IMPORTED_MODULE_14__.Z})],D.prototype,"filter",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_30__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)()],D.prototype,"viewFilter",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_30__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)(q.requiredFields)],D.prototype,"requiredFields",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_30__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)(q.availableFields)],D.prototype,"availableFields",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_30__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)()],D.prototype,"fieldsHelper",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_30__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)()],D.prototype,"floorFilterClause",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_30__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({readOnly:!0,aliasOf:"view.qualitySettings.sceneService.3dObject.lodFactor"})],D.prototype,"lodFactor",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_30__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({readOnly:!0,aliasOf:"_controller.updatingProgress"})],D.prototype,"updatingProgressValue",void 0),D=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_30__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_4__.j)("esri.views.3d.layers.SceneLayerView3D")],D);const __WEBPACK_DEFAULT_EXPORT__=D},56527:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{s:()=>s,Z:()=>i});var _core_lang_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(67134),_core_maybe_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(61681),_support_attributeUtils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(19405);const o={setAttribute(){},rollback(){},commit(){}};function s(e,r){const s=r.attributes[e.objectIdField],i=e.sessions.get(s);if(i)return i;const a=(0,_core_lang_js__WEBPACK_IMPORTED_MODULE_0__.d9)(r.attributes),u=new Set;if(null==s)return o;const c=e.attributeOverrides.createInteractiveEditSession(s),f=new Map,l=(t,e)=>{const n=f.get(t);if(null==n){const n=e.indexOf(s);return f.set(t,n),n}return n};let d=0;const b={setAttribute(t,o){if(0!==d)return;const s=e.fieldsIndex.get(t);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_1__.Wi)(s))return;const i=e.attributeStorageInfo.findIndex((t=>t.name===s.name));if(i<0)return;c.set(i,o);const a=e.attributeStorageInfo[i];let f=!1;u.add(t),e.forEachNode(((t,n)=>{const s=l(t,n);if(-1===s)return;const i=e.getAttributeData(t.index);if(i){const n=i[a.name];n&&(n[s]=o,e.setAttributeData(t.index,i,r),f=!0)}})),f&&e.clearMemCache()},rollback(){if(0===d){for(const t of u)this.setAttribute(t,a[t]);c.rollback(),d=1,e.sessions.delete(s)}},commit(){0===d&&(c.commit(),d=2,e.sessions.delete(s))}};return e.sessions.set(s,b),b}function i(t,n){const r=function a(t,e){const n=e.edits.updateFeatures;if(!n||0===n.length)return new d;const o=function f(t){const e=new Set;if(!t.updatedFeatures)return e;for(const n of t.updatedFeatures)null!=n.objectId&&null==n.error&&e.add(n.objectId);return e}(e),s=new d,i=new Map;for(let r=0;r<t.attributeStorageInfo.length;r++)i.set(t.attributeStorageInfo[r].name,r);const a=t.fieldsIndex,c=t.objectIdField,l=n.filter((t=>{const e=(0,_support_attributeUtils_js__WEBPACK_IMPORTED_MODULE_2__.g)(a,t.attributes,c);return o.has(e)}));return t.forEachNode(((e,n)=>{const o=new Set(n);for(const i of l){const f=(0,_support_attributeUtils_js__WEBPACK_IMPORTED_MODULE_2__.g)(a,i.attributes,c);if(!o.has(f))continue;const l=n.indexOf(f);for(const n in i.attributes){const r=t.fieldsIndex.normalizeFieldName(n),o=u(s,e.index,r),a=i.attributes[n];o.push({featureIndex:l,featureId:f,value:a})}}})),s}(t,n);if(0===r.size)return;const o=new Map;for(let e=0;e<t.attributeStorageInfo.length;e++)o.set(t.attributeStorageInfo[e].name,e);let s=!1;r.forEach(((n,r)=>{const i=t.getAttributeData(r);let a=!1;n.forEach(((n,r)=>{const u=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_1__.pC)(i)?i[r]:null,c=o.get(r);for(const{featureIndex:e,value:o,featureId:i}of n)u&&(u[e]=o,a=!0,s=!0),t.attributeOverrides.updateValue(i,c,o)})),a&&t.setAttributeData(r,i,null)})),s&&t.clearMemCache()}function u(t,e,n){const r=function c(t,e){const n=t.get(e);if(n)return n;const r=new l;return t.set(e,r),r}(t,e),o=r.get(n);if(o)return o;const s=new Array;return r.set(n,s),s}const l=Map,d=Map},44613:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{i:()=>c});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(36663),_core_maybe_js__WEBPACK_IMPORTED_MODULE_11__=(__webpack_require__(39994),__webpack_require__(61681)),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_4__=(__webpack_require__(13802),__webpack_require__(7283),__webpack_require__(81977),__webpack_require__(12571)),_core_Error_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(70375),_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_9__=(__webpack_require__(3466),__webpack_require__(12173),__webpack_require__(51876),__webpack_require__(14845)),_layers_support_popupUtils_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(59439);const c=c=>{let u=class extends c{_validateFetchPopupFeatures(e){const{layer:r}=this,{popupEnabled:s}=r;return s?(0,_layers_support_popupUtils_js__WEBPACK_IMPORTED_MODULE_10__.V)(r,e)?void 0:new _core_Error_js__WEBPACK_IMPORTED_MODULE_5__.Z("scenelayerview3d:fetchPopupFeatures","Layer does not define a popup template",{layer:r}):new _core_Error_js__WEBPACK_IMPORTED_MODULE_5__.Z("scenelayerview3d:fetchPopupFeatures","Popups are disabled",{layer:r})}async prepareFetchPopupFeatures(e){}async fetchPopupFeatures(e,s){const t=this._validateFetchPopupFeatures(s);if(t)return Promise.reject(t);const c=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_11__.pC)(s)?s.clientGraphics:null;if(!c||0===c.length)return Promise.resolve([]);const u=[],l=[],n="scene"===this.layer.type&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_11__.pC)(this.layer.associatedLayer)?this.layer.associatedLayer:this.layer,h=(0,_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_9__.Lk)(this.layer.fields,await(0,_layers_support_popupUtils_js__WEBPACK_IMPORTED_MODULE_10__.e)(n,(0,_layers_support_popupUtils_js__WEBPACK_IMPORTED_MODULE_10__.V)(this.layer,s)));await this.prepareFetchPopupFeatures(h);const m=new Set;for(const r of c)(0,_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_9__.Gm)(h,r,m)?l.push(r):u.push(r);return 0===l.length?Promise.resolve(u):this.whenGraphicAttributes(l,[...m]).catch((()=>l)).then((e=>u.concat(e)))}};return u=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_12__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_4__.j)("esri.views.3d.layers.support.PopupSceneLayerView")],u),u}},37495:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{K:()=>SceneLayerViewRequiredFields_c});var tslib_es6=__webpack_require__(36663),maybe=(__webpack_require__(39994),__webpack_require__(61681)),Logger=__webpack_require__(13802),property=(__webpack_require__(7283),__webpack_require__(81977)),subclass=__webpack_require__(12571),fieldUtils=(__webpack_require__(3466),__webpack_require__(12173),__webpack_require__(51876),__webpack_require__(14845)),tracking=__webpack_require__(55860),SimpleTrackingTarget=__webpack_require__(24163),Accessor=__webpack_require__(53443);const c=a=>{let r=class extends a{constructor(){super(...arguments),this.asyncUpdateState=new Map}autoUpdateAsync(t,s){return function o(t,s){const e=()=>{o&&!p&&t(n)},n=()=>{if(!o||p)return s();o.clear(),p=!0;const t=(0,tracking.LJ)(o,s);return p=!1,t},c=()=>{o&&(o.destroy(),o=null)};let o=new SimpleTrackingTarget.M(e),p=!1;return t(n),{remove:c}}((s=>this.updateAsync(t,s)),s)}async updateAsync(t,e){if(!this.startAsyncUpdate(t)){try{const s=await e();this._set(t,s)}catch(a){Logger.Z.getLogger(this.declaredClass).warn(`Async update of "${t}" failed. Async update functions should not throw exceptions.`)}this.endAsyncUpdate(t)&&this.updateAsync(t,e)}}startAsyncUpdate(t){var s;const e=null!=(s=this.asyncUpdateState.get(t))?s:0;return 1&e?(this.asyncUpdateState.set(t,2|e),!0):(this.asyncUpdateState.set(t,1|e),!1)}endAsyncUpdate(t){var s;const e=-2&(null!=(s=this.asyncUpdateState.get(t))?s:0);return 2&e?(this.asyncUpdateState.set(t,-3&e),!0):(this.asyncUpdateState.set(t,e),!1)}};return r=(0,tslib_es6._)([(0,subclass.j)("esri.core.AsyncUpdate")],r),r};let p=class extends(c(Accessor.Z)){};p=(0,tslib_es6._)([(0,subclass.j)("esri.core.AsyncUpdate")],p);var HandleOwner=__webpack_require__(53280);const n=Logger.Z.getLogger("esri.views.3d.layers.support.SceneLayerViewRequiredFields");let SceneLayerViewRequiredFields_c=class extends(c(HandleOwner.r)){constructor(e){super(e)}get requiredFields(){const{layerView:{layer:{fields:e},definitionExpressionFields:s},rendererFields:t,labelingFields:i,viewFilterFields:l}=this;return(0,fieldUtils.Q0)(e,[...(0,maybe.Pt)(s,[]),...(0,maybe.Pt)(t,[]),...(0,maybe.Pt)(i,[]),...(0,maybe.Pt)(l,[])])}initialize(){const e=this.layerView.layer;this.layer=e,this.handles.add([this.autoUpdateAsync("rendererFields",(()=>{const{fields:e,renderer:r}=this.layer;return r?u((s=>r.collectRequiredFields(s,e))):null})),this.autoUpdateAsync("labelingFields",(()=>{const{layer:e}=this;return e.labelsVisible?u((r=>(0,fieldUtils.Mu)(r,e))):null})),this.autoUpdateAsync("viewFilterFields",(()=>{const{layer:e,filter:r}=this.layerView;return u((s=>(0,fieldUtils.Ll)(s,e,r)))}))])}};async function u(e){const r=new Set;try{return await e(r),Array.from(r).sort()}catch(s){return n.error(s),null}}(0,tslib_es6._)([(0,property.Cb)()],SceneLayerViewRequiredFields_c.prototype,"layerView",void 0),(0,tslib_es6._)([(0,property.Cb)()],SceneLayerViewRequiredFields_c.prototype,"layer",void 0),(0,tslib_es6._)([(0,property.Cb)()],SceneLayerViewRequiredFields_c.prototype,"requiredFields",null),(0,tslib_es6._)([(0,property.Cb)()],SceneLayerViewRequiredFields_c.prototype,"rendererFields",void 0),(0,tslib_es6._)([(0,property.Cb)()],SceneLayerViewRequiredFields_c.prototype,"labelingFields",void 0),(0,tslib_es6._)([(0,property.Cb)()],SceneLayerViewRequiredFields_c.prototype,"viewFilterFields",void 0),SceneLayerViewRequiredFields_c=(0,tslib_es6._)([(0,subclass.j)("esri.views.3d.layers.support.SceneLayerViewRequiredFields")],SceneLayerViewRequiredFields_c)},3917:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{v:()=>i});var _layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(14845);function i(){return{requiredFields:{type:[String],readOnly:!0},availableFields:{type:[String],readOnly:!0,get:function(){const{layer:i,layer:{fields:t},requiredFields:l}=this;return i.outFields?(0,_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_0__.Q0)(t,[...(0,_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_0__.Lk)(t,i.outFields),...l]):(0,_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_0__.Q0)(t,l)}}}}},80876:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{function o(o){const n=o.layer;if("floorInfo"in n&&n.floorInfo){const r=o.view.floors;if(!r||!r.length)return null;const l=r.filter((o=>""!==o)).map((o=>`'${o}'`));l.push("''");const f=n.floorInfo.floorField;return`${f} IN (${l.join(", ")}) OR ${f} IS NULL`}return null}__webpack_require__.d(__webpack_exports__,{c:()=>o})},21808:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(36663),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__=(__webpack_require__(39994),__webpack_require__(13802),__webpack_require__(7283),__webpack_require__(81977)),_LayerView_js__WEBPACK_IMPORTED_MODULE_8__=(__webpack_require__(3593),__webpack_require__(3466),__webpack_require__(12173),__webpack_require__(51876),__webpack_require__(26216));class o extends _LayerView_js__WEBPACK_IMPORTED_MODULE_8__.Z{constructor(){super(...arguments),this.layer=null,this.filter=null}get availableFields(){return[]}get maximumNumberOfFeatures(){return 0}set maximumNumberOfFeatures(e){throw new Error("Not implemented")}get maximumNumberOfFeaturesExceeded(){return!1}highlight(e){throw new Error("Not implemented")}queryFeatures(e,r){throw new Error("Not implemented")}queryObjectIds(e,r){throw new Error("Not implemented")}queryFeatureCount(e,r){throw new Error("Not implemented")}createQuery(){throw new Error("Not implemented")}queryExtent(e,r){throw new Error("Not implemented")}}(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_9__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)()],o.prototype,"layer",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_9__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)()],o.prototype,"availableFields",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_9__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)()],o.prototype,"maximumNumberOfFeatures",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_9__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)({readOnly:!0})],o.prototype,"maximumNumberOfFeaturesExceeded",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_9__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_3__.Cb)()],o.prototype,"filter",void 0);const __WEBPACK_DEFAULT_EXPORT__=o}}]);