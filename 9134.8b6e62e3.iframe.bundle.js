"use strict";(self.webpackChunkreact_arcgis_wmws=self.webpackChunkreact_arcgis_wmws||[]).push([[9134],{6415:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{I:()=>n,b:()=>s});var _views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(23410),_views_3d_webgl_engine_core_shaderLibrary_Transform_glsl_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(4731),_views_3d_webgl_engine_core_shaderModules_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(3961),_views_3d_webgl_engine_core_shaderLibrary_util_ColorConversion_glsl_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(32394),_views_3d_webgl_engine_core_shaderLibrary_Slice_glsl_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5885),_views_3d_webgl_engine_core_shaderLibrary_output_ReadLinearDepth_glsl_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(6665),_views_3d_webgl_engine_core_shaderLibrary_util_AlphaDiscard_glsl_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(41272),_views_3d_webgl_engine_core_shaderLibrary_shading_MultipassTerrainTest_glsl_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(73393);function s(s){const n=new _views_3d_webgl_engine_core_shaderModules_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_2__.kG;return n.include(_views_3d_webgl_engine_core_shaderLibrary_Transform_glsl_js__WEBPACK_IMPORTED_MODULE_1__.w,{linearDepth:!1}),n.vertex.uniforms.add("proj","mat4").add("view","mat4"),n.attributes.add("position","vec3"),n.attributes.add("uv0","vec2"),n.varyings.add("vpos","vec3"),s.multipassTerrainEnabled&&n.varyings.add("depth","float"),n.vertex.uniforms.add("textureCoordinateScaleFactor","vec2"),n.vertex.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__.H`
    void main(void) {
      vpos = position;
      ${s.multipassTerrainEnabled?"depth = (view * vec4(vpos, 1.0)).z;":""}
      vTexCoord = uv0 * textureCoordinateScaleFactor;
      gl_Position = transformPosition(proj, view, vpos);
    }
  `),n.include(_views_3d_webgl_engine_core_shaderLibrary_Slice_glsl_js__WEBPACK_IMPORTED_MODULE_4__.p,s),s.multipassTerrainEnabled&&(n.fragment.include(_views_3d_webgl_engine_core_shaderLibrary_output_ReadLinearDepth_glsl_js__WEBPACK_IMPORTED_MODULE_5__.S),n.include(_views_3d_webgl_engine_core_shaderLibrary_shading_MultipassTerrainTest_glsl_js__WEBPACK_IMPORTED_MODULE_7__.l,s)),n.fragment.uniforms.add("tex","sampler2D"),n.fragment.uniforms.add("opacity","float"),n.varyings.add("vTexCoord","vec2"),7===s.output?n.fragment.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__.H`
    void main() {
      discardBySlice(vpos);
      ${s.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":""}

      float alpha = texture2D(tex, vTexCoord).a * opacity;
      if (alpha  < ${_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__.H.float(_views_3d_webgl_engine_core_shaderLibrary_util_AlphaDiscard_glsl_js__WEBPACK_IMPORTED_MODULE_6__.F)}) {
        discard;
      }

      gl_FragColor = vec4(alpha);
    }
    `):(n.fragment.include(_views_3d_webgl_engine_core_shaderLibrary_util_ColorConversion_glsl_js__WEBPACK_IMPORTED_MODULE_3__.Y),n.fragment.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__.H`
    void main() {
      discardBySlice(vpos);
      ${s.multipassTerrainEnabled?"terrainDepthTest(gl_FragCoord, depth);":""}
      gl_FragColor = texture2D(tex, vTexCoord) * opacity;

      if (gl_FragColor.a < ${_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_0__.H.float(_views_3d_webgl_engine_core_shaderLibrary_util_AlphaDiscard_glsl_js__WEBPACK_IMPORTED_MODULE_6__.F)}) {
        discard;
      }

      gl_FragColor = highlightSlice(gl_FragColor, vpos);
      ${s.OITEnabled?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}
    }
    `)),n}var n=Object.freeze({__proto__:null,build:s})},99134:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(36663),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_4__=(__webpack_require__(39994),__webpack_require__(13802),__webpack_require__(7283),__webpack_require__(81977),__webpack_require__(12571)),_DynamicLayerView3D_js__WEBPACK_IMPORTED_MODULE_8__=(__webpack_require__(3466),__webpack_require__(12173),__webpack_require__(51876),__webpack_require__(65425));let e=class extends _DynamicLayerView3D_js__WEBPACK_IMPORTED_MODULE_8__.Z{};e=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_9__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_4__.j)("esri.views.3d.layers.BaseDynamicLayerView3D")],e);const __WEBPACK_DEFAULT_EXPORT__=e},65425:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>DynamicLayerView3D});var tslib_es6=__webpack_require__(36663),Logger=(__webpack_require__(39994),__webpack_require__(13802)),property=(__webpack_require__(7283),__webpack_require__(81977)),subclass=__webpack_require__(12571),promiseUtils=(__webpack_require__(3466),__webpack_require__(12173),__webpack_require__(51876),__webpack_require__(78668)),Extent=__webpack_require__(91772),asyncUtils=__webpack_require__(67979),watchUtils=__webpack_require__(15071),aaBoundingRect=__webpack_require__(24568),RefreshableLayerView=__webpack_require__(55068),debugFlags=__webpack_require__(3289),RenderGeometry=__webpack_require__(13304),Texture=__webpack_require__(44101),LayerView3D=__webpack_require__(19654),LayerView=__webpack_require__(26216),GLMaterialTexture=__webpack_require__(11327),MaterialUtil=__webpack_require__(25584),Material=__webpack_require__(7358),OrderIndependentTransparency=__webpack_require__(12045),DefaultBufferWriter=__webpack_require__(89339),ReloadableShaderModule=__webpack_require__(9969),ShaderTechnique=__webpack_require__(52756),ShaderTechniqueConfiguration=__webpack_require__(67197),DefaultVertexAttributeLocations=__webpack_require__(5474),Program=__webpack_require__(69002),renderState=__webpack_require__(17346),View_glsl=__webpack_require__(84614),Slice_glsl=__webpack_require__(5885),MultipassTerrainTest_glsl=__webpack_require__(73393),StencilUtils=__webpack_require__(79040),ImageMaterial_glsl=__webpack_require__(6415);class j extends ShaderTechnique.A{initializeProgram(e){const t=j.shader.get(),r=this.configuration,i=t.build({output:r.output,slicePlaneEnabled:r.slicePlaneEnabled,sliceHighlightDisabled:!1,sliceEnabledForVertexPrograms:!1,OITEnabled:0===r.transparencyPassType,multipassTerrainEnabled:r.multipassTerrainEnabled,cullAboveGround:r.cullAboveGround});return new Program.Z(e.rctx,i.generateSource("vertex"),i.generateSource("fragment"),DefaultVertexAttributeLocations.i)}bindPass(e,t,r){View_glsl.G.bindProjectionMatrix(this.program,r.camera.projectionMatrix),this.program.setUniform1f("opacity",t.opacity),r.multipassTerrainEnabled&&(this.program.setUniform2fv("cameraNearFar",r.camera.nearFar),this.program.setUniform2fv("inverseViewport",r.inverseViewport),(0,MultipassTerrainTest_glsl.C)(this.program,e,r))}bindDraw(e){View_glsl.G.bindView(this.program,e),Slice_glsl.p.bindUniformsWithOrigin(this.program,this.configuration,e)}setPipelineState(e,t){const r=this.configuration,i=3===e,s=2===e;return(0,renderState.sm)({blending:0!==r.output&&7!==r.output||!r.transparent?null:i?S:(0,OrderIndependentTransparency.$L)(e),culling:(e=>0!==e&&{face:1===e?1028:1029,mode:2305})(r.cullFace),depthTest:{func:(0,OrderIndependentTransparency.$x)(e)},depthWrite:i?r.writeDepth&&renderState.LZ:(0,OrderIndependentTransparency.Vc)(e),colorWrite:renderState.BK,stencilWrite:r.sceneHasOcludees?StencilUtils.s3:null,stencilTest:r.sceneHasOcludees?t?StencilUtils.eD:StencilUtils.RY:null,polygonOffset:i||s?null:(0,OrderIndependentTransparency.je)(r.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this.setPipelineState(this.configuration.transparencyPassType,!0),this.setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(e){return e?this._occludeePipelineState:this.pipeline}}j.shader=new ReloadableShaderModule.J(ImageMaterial_glsl.I,(()=>__webpack_require__.e(7204).then(__webpack_require__.bind(__webpack_require__,47204))));const S=(0,renderState.if)(1,771);class w extends ShaderTechniqueConfiguration.m{constructor(){super(...arguments),this.output=0,this.cullFace=0,this.slicePlaneEnabled=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!0,this.sceneHasOcludees=!1,this.transparencyPassType=3,this.multipassTerrainEnabled=!1,this.cullAboveGround=!0}}(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.o)({count:8})],w.prototype,"output",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.o)({count:3})],w.prototype,"cullFace",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.o)()],w.prototype,"slicePlaneEnabled",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.o)()],w.prototype,"transparent",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.o)()],w.prototype,"enableOffset",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.o)()],w.prototype,"writeDepth",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.o)()],w.prototype,"sceneHasOcludees",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.o)({count:4})],w.prototype,"transparencyPassType",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.o)()],w.prototype,"multipassTerrainEnabled",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.o)()],w.prototype,"cullAboveGround",void 0);class c extends Material.F5{constructor(e){super(e,o),this.supportsEdges=!0,this.techniqueConfig=new w}getTechniqueConfig(e,t){return this.techniqueConfig.output=e,this.techniqueConfig.cullFace=this.params.cullFace,this.techniqueConfig.slicePlaneEnabled=this.params.slicePlaneEnabled,this.techniqueConfig.transparent=this.params.transparent,this.techniqueConfig.writeDepth=this.params.writeDepth,this.techniqueConfig.sceneHasOcludees=this.params.sceneHasOcludees,this.techniqueConfig.transparencyPassType=t?t.transparencyPassType:3,this.techniqueConfig.enableOffset=!t||t.camera.relativeElevation<OrderIndependentTransparency.ve,this.techniqueConfig.multipassTerrainEnabled=!!t&&t.multipassTerrainEnabled,this.techniqueConfig.cullAboveGround=!t||t.cullAboveGround,this.techniqueConfig}intersect(e,i,a,s,r,n,u){(0,MaterialUtil.Bw)(e,i,s,r,n,void 0,u)}getGLMaterial(e){return 0===e.output||7===e.output||4===e.output?new l(e):void 0}createBufferWriter(){return new DefaultBufferWriter.G_(DefaultBufferWriter.W1)}}class l extends GLMaterialTexture.Z{constructor(e){super({...e,...e.material.params}),this.updateParameters()}updateParameters(e){const t=this.material.params;this.updateTexture(t.textureId),this.technique=this.techniqueRep.acquireAndReleaseExisting(j,this.material.getTechniqueConfig(this.output,e),this.technique)}beginSlot(e){return 4===this.output?3===e:e===(this.technique.configuration.transparent?this.technique.configuration.writeDepth?5:8:3)}_updateOccludeeState(e){e.hasOccludees!==this.material.params.sceneHasOcludees&&(this.material.setParameterValues({sceneHasOcludees:e.hasOccludees}),this.updateParameters(e))}ensureParameters(e){0!==this.output&&7!==this.output||this._updateOccludeeState(e),this.updateParameters(e)}bind(e,t){e.bindProgram(this.technique.program),this.bindTexture(e,this.technique.program),this.bindTextureScale(e,this.technique.program),this.technique.bindPass(e,this.material.params,t)}getPipelineState(e,t){return this.technique.getPipelineState(t)}}const o={transparent:!1,writeDepth:!0,slicePlaneEnabled:!1,cullFace:0,sceneHasOcludees:!1,opacity:1,textureId:null,initTextureTransparent:!0,...Material.zh};var Geometry=__webpack_require__(47562),GeometryUtil=__webpack_require__(6087);function overlayImageUtils_a(t,e){const n=[[t[0],t[1],e],[t[2],t[1],e],[t[2],t[3],e],[t[0],t[3],e]];return GeometryUtil.Z.createSquareGeometry(n)}function h(t,e,o){if(!(0,aaBoundingRect.kK)(t,e))return overlayImageUtils_a(e,o);const r=[t[1]-e[1],Math.min(t[3],e[3])-Math.max(t[1],e[1]),e[3]-t[3],123456],h=[t[0]-e[0],Math.min(t[2],e[2])-Math.max(t[0],e[0]),e[2]-t[2],123456],u=e[2]-e[0],l=e[3]-e[1],c=h[0]>0&&h[2]>0?3:2,m=r[0]>0&&r[2]>0?3:2,g=(m+1)*(c+1),w=new Float64Array(3*g),d=new Float32Array(2*g),f=new Uint32Array(6*(m*c-1));let p=0,y=0,x=0,M=0,v=0;for(let n=0;n<4;n++){const t=r[n];if(t<=0)continue;let i=0;for(let r=0;r<4;r++){const t=h[r];t<=0||(w[y++]=e[0]+i,w[y++]=e[1]+p,w[y++]=o,d[x++]=i/u,d[x++]=p/l,r<3&&n<3&&(1!==r||1!==n)&&(f[v++]=M,f[v++]=M+1,f[v++]=M+c+1,f[v++]=M+1,f[v++]=M+c+2,f[v++]=M+c+1),M++,i+=t)}p+=t}const b=new Uint32Array(f.length);return new Geometry.Z([["position",{size:3,data:w,exclusive:!0}],["normal",{size:3,data:s,exclusive:!0}],["uv0",{size:2,data:d,exclusive:!0}]],[["position",f],["normal",b],["uv0",f]])}const s=[0,0,1];var projectExtentUtils=__webpack_require__(53986);const M=Logger.Z.getLogger("esri.views.3d.layers.DynamicLayerView3D");let T=class extends((0,RefreshableLayerView.yc)((0,LayerView3D.A)(LayerView.Z))){constructor(){super(...arguments),this.drapeSourceType=0,this.fullExtentInLocalViewSpatialReference=null,this.maximumDataResolution=null,this._images=new Array,this._extents=new Array,this._overlayExtents=new Array,this.updateWhenStationary=!0}initialize(){this.addResolvingPromise((0,projectExtentUtils.E)(this).then((e=>this._set("fullExtentInLocalViewSpatialReference",e)))),this.updatingHandles.add(this,"suspended",(()=>this._suspendedChangeHandler())),this.handles.add(this.view.resourceController.scheduler.registerIdleStateCallbacks((()=>{this._isScaleRangeActive()&&this.notifyChange("suspended")}),(()=>{}))),this._isScaleRangeLayer()&&this.updatingHandles.add(this.layer,"scaleRangeId",(()=>this.notifyChange("suspended"))),"local"===this.view.viewingMode&&this.updatingHandles.add(this.view.basemapTerrain,"extent",(()=>this._overlayExtents.forEach(((e,t)=>this._updateImageExtent(t)))))}destroy(){this.clear()}setDrapingExtent(e,t,i,r,a,s){this._overlayExtents[e]={extent:(0,aaBoundingRect.Ue)(t),spatialReference:i,resolution:r,renderLocalOrigin:a,pixelRatio:s},this._updateImageExtent(e)}_updateImageExtent(e){const t=this._overlayExtents[e],i=this._clippedExtent(t.extent,H),r=function overlayImageUtils_r(n,i,o){const r=(0,aaBoundingRect.bf)(n)/(0,aaBoundingRect.Cb)(n),a={width:o,height:o};return r>1.0001?a.height=o/r:r<.9999&&(a.width=o*r),a.width=Math.round(a.width/((0,aaBoundingRect.bf)(n)/(0,aaBoundingRect.bf)(i))),a.height=Math.round(a.height/((0,aaBoundingRect.Cb)(n)/(0,aaBoundingRect.Cb)(i))),a}(t.extent,i,t.resolution);let s=t.pixelRatio*this.view.pixelRatio;if("imageMaxWidth"in this.layer||"imageMaxHeight"in this.layer){const e=this.layer.imageMaxWidth,t=this.layer.imageMaxHeight;if(r.width>e){const t=e/r.width;r.height=Math.floor(r.height*t),r.width=e,s*=t}if(r.height>t){const e=t/r.height;r.width=Math.floor(r.width*e),r.height=t,s*=e}}const n=this._extents[e];n&&(0,aaBoundingRect.fS)(n.extent,i)&&!this._imageSizeDiffers(i,n.imageSize,r)||(this._extents[e]={extent:(0,aaBoundingRect.Ue)(i),spatialReference:t.spatialReference,imageSize:r,pixelRatio:s},this.suspended||this._fetch(e).catch((e=>{(0,promiseUtils.D_)(e)||M.error(e)})))}clear(){for(let e=0;e<this._images.length;e++)this._clearImage(e)}async doRefresh(e){if(this.suspended)return;const t=[];for(let i=0;i<this._extents.length;i++)this._extents[i]&&t.push(this._fetch(i,e));await(0,promiseUtils.as)(t)}canResume(){if(!super.canResume())return!1;if(this._isScaleRangeLayer()){const{minScale:e,maxScale:t}=this.layer;if(e>0||t>0){const i=this.view.scale;if(i<t||e>0&&i>e)return!1}}return!0}isUpdating(){return this._images.some((e=>!!e.loadingPromise))}async processResult(e,t,i){(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement)&&(e.image=t)}findExtentInfoAt(e){for(const t of this._extents){const i=t.extent;if(new Extent.Z(i[0],i[1],i[2],i[3],t.spatialReference).contains(e))return t}return null}getFetchOptions(){}async redraw(e,t){await(0,asyncUtils.Ed)(this._images,(async(i,r)=>{i&&(await e(i,t),this._createStageObjects(r,i.image))}))}_imageSizeDiffers(e,t,i){if(!this.maximumDataResolution)return!0;if(debugFlags.Z.TESTS_DISABLE_UPDATE_THRESHOLDS)return!0;const r=(0,aaBoundingRect.bf)(e)/this.maximumDataResolution.x,a=(0,aaBoundingRect.Cb)(e)/this.maximumDataResolution.y,s=r/t.width,n=a/t.height,o=r/i.width,l=a/i.height,h=Math.abs(s-o),m=Math.abs(n-l);return h>1.5||m>1.5}async _fetch(e,t){if(this.suspended)return;const i=this._overlayExtents[e],r=this._extents[e],s=r.extent,d=new Extent.Z(s[0],s[1],s[2],s[3],r.spatialReference);this._images[e]||(this._images[e]={texture:null,material:null,rendergeometry:null,loadingPromise:null,loadingAbortController:null,image:null,pixelData:null,renderExtent:(0,aaBoundingRect.Ue)(s)});const g=this._images[e];if(g.loadingAbortController&&(g.loadingAbortController.abort(),g.loadingAbortController=null),0===d.width||0===d.height)return void this._clearImage(e);const u=(0,promiseUtils.yi)();g.loadingAbortController=u,(0,promiseUtils.fu)(t,(()=>u.abort()));const y=u.signal,f=this._waitFetchReady(y).then((()=>{const e={requestAsImageElement:!0,pixelRatio:i.pixelRatio,...this.getFetchOptions(),signal:y},{height:t,width:a}=r.imageSize;return e.timestamp=this.refreshTimestamp,this.layer.fetchImage(d,a,t,e)})).then((e=>{if((0,promiseUtils.Hc)(y))throw M.warnOnce("A call to fetchImage resolved even though the request was aborted. fetchImage should not resolve if options.signal.aborted is true."),(0,promiseUtils.zE)();return this.processResult(g,e)}));g.loadingPromise=f,(0,promiseUtils.Bx)(f,(()=>{f===g.loadingPromise&&(g.loadingPromise=null,g.loadingAbortController=null)}));const x=f.then((()=>{(0,aaBoundingRect.t8)(g.renderExtent,s),this._createStageObjects(e,g.image),this.notifyChange("updating")})).catch((e=>{throw e&&!(0,promiseUtils.D_)(e)&&M.error(e),this.notifyChange("updating"),e}));this.notifyChange("updating"),await x}_clearImage(e){const t=this._images[e],i=this.view._stage;t&&(t.rendergeometry&&(this.view.basemapTerrain.overlayManager.renderer.removeGeometries([t.rendergeometry],this,2),t.rendergeometry=null),t.texture&&(i.remove(t.texture),t.texture=null),t.material&&(i.remove(t.material),t.material=null),t.loadingAbortController&&(t.loadingAbortController.abort(),t.loadingAbortController=null),t.loadingPromise=null,t.image=null,t.pixelData=null)}_createStageObjects(e,t){const i=this.view._stage,r=this._images[e];r.texture&&(i.remove(r.texture),r.texture=null),t?(r.texture=new Texture.x(t,{width:t.width,height:t.height,preMultiplyAlpha:!0,wrap:{s:33071,t:33071}}),i.add(r.texture)):r.material&&(i.remove(r.material),r.material=null),!r.material&&r.texture?(r.material=new c({transparent:!0,textureId:r.texture.id}),i.add(r.material)):r.material&&t&&r.material.setParameterValues({textureId:r.texture.id});const a=this.view.basemapTerrain.overlayManager.renderer;if(r.material){const t=-1;let i;const s=this._overlayExtents[e].renderLocalOrigin;if(0===e)i=overlayImageUtils_a(r.renderExtent,t);else{if(1!==e)return void console.error("DynamicLayerView3D._createStageObjects: Invalid extent idx");{const e=this._extents[0].extent;if(!e)return;i=h(e,r.renderExtent,t)}}const n=new RenderGeometry.z(i,r.material);n.origin=s,a.addGeometries([n],this,2),r.rendergeometry&&a.removeGeometries([r.rendergeometry],this,2),r.rendergeometry=n}else r.rendergeometry&&(a.removeGeometries([r.rendergeometry],this,2),r.rendergeometry=null)}_isScaleRangeLayer(){return"minScale"in this.layer&&"maxScale"in this.layer}_isScaleRangeActive(){return!!this._isScaleRangeLayer()&&(this.layer.minScale>0||this.layer.maxScale>0)}_clippedExtent(e,t){if("local"!==this.view.viewingMode)return(0,aaBoundingRect.t8)(t,e);const i=this.view.basemapTerrain,r=i.extent;return i.ready&&r?(0,aaBoundingRect.jV)(e,r,t):(0,aaBoundingRect.t8)(t,e)}_suspendedChangeHandler(){this.suspended?this.clear():this.refresh()}async _waitFetchReady(e){this.updateWhenStationary&&await(0,watchUtils.N1)(this.view,"stationary",e),(0,promiseUtils.k_)(e)}};(0,tslib_es6._)([(0,property.Cb)()],T.prototype,"layer",void 0),(0,tslib_es6._)([(0,property.Cb)()],T.prototype,"suspended",void 0),(0,tslib_es6._)([(0,property.Cb)({readOnly:!0})],T.prototype,"fullExtentInLocalViewSpatialReference",void 0),(0,tslib_es6._)([(0,property.Cb)()],T.prototype,"updating",void 0),T=(0,tslib_es6._)([(0,subclass.j)("esri.views.3d.layers.DynamicLayerView3D")],T);const H=(0,aaBoundingRect.Ue)();const DynamicLayerView3D=T},53986:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{E:()=>t});var _geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(39536),_portal_support_geometryServiceUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(8060);function t(t){const l=t.view.spatialReference,s=t.layer.fullExtent,i=s&&s.spatialReference;return i?i.equals(l)?Promise.resolve(s.clone()):(0,_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_0__.Q8)(i,l)?Promise.resolve((0,_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_0__.iV)(s,l)):t.view.state.isLocal?(0,_portal_support_geometryServiceUtils_js__WEBPACK_IMPORTED_MODULE_1__.projectGeometry)(s,l,t.layer.portalItem).then((e=>!t.destroyed&&e?e:void 0)).catch((()=>null)):Promise.resolve(null):Promise.resolve(null)}}}]);
//# sourceMappingURL=9134.8b6e62e3.iframe.bundle.js.map